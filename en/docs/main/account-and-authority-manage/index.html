<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-main/account-and-authority-manage">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">账户管理和权限管理 | Linux Learning</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://linux.cworld.top/en/docs/main/account-and-authority-manage"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="账户管理和权限管理 | Linux Learning"><meta data-rh="true" name="description" content="关于 Linux 账户管理和用户权限配置的讲解。"><meta data-rh="true" property="og:description" content="关于 Linux 账户管理和用户权限配置的讲解。"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linux.cworld.top/en/docs/main/account-and-authority-manage"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/account-and-authority-manage" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/en/docs/main/account-and-authority-manage" hreflang="en"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/account-and-authority-manage" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.19e3709a.css">
<link rel="preload" href="/en/assets/js/runtime~main.6c22165c.js" as="script">
<link rel="preload" href="/en/assets/js/main.35fdb439.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_BBcs" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="CWorld Logo" class="themedImage_J2sv themedImage--light_cbVa"><img src="/en/img/logo.svg" alt="CWorld Logo" class="themedImage_J2sv themedImage--dark_jfGI"></div><b class="navbar__title text--truncate">CWorld Project</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/">笔记</a></div><div class="navbar__items navbar__items--right"><a href="https://cworld.top/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">博客</a><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_RTLM"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/main/account-and-authority-manage" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/main/account-and-authority-manage" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="toggle_pcYR colorModeToggle_B47n"><button class="clean-btn toggleButton_gqls toggleButtonDisabled_LqzU" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_O59b"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_mYor"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_Lb93"><div class="navbar__search searchBarContainer_LsXR"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_b4Y7 searchBarLoadingRing_Lsyu"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_cwhP docsWrapper_amJP"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_jxU9" type="button"></button><div class="docPage_H5uh"><aside class="theme-doc-sidebar-container docSidebarContainer_APgW"><div class="sidebarViewport_h9Qd"><div class="sidebar_m_4B"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_aK5t"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/">笔记简述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/课程说明">课程说明</a><button aria-label="Toggle the collapsible sidebar category &#x27;课程说明&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/category/主要章节">主要章节</a><button aria-label="Toggle the collapsible sidebar category &#x27;主要章节&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/linux-intro-and-install">Linux 介绍和安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/adv-char-operation">字符界面操作进阶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/disk-part-and-lvm">磁盘分区和 LVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/file-sys-manage">文件系统管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/main/account-and-authority-manage">账户管理和权限管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/network-config-and-tools">网络配置与网络工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/process-management">进程管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/main/sys-monitor-and-log">系统监视与系统日志</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/category/附加章节">附加章节</a><button aria-label="Toggle the collapsible sidebar category &#x27;附加章节&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_yIQ5"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_dpSd"><div class="docItemContainer_odLl"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__9vB" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_BZAf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/category/主要章节"><span itemprop="name">主要章节</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">账户管理和权限管理</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_uPSR theme-doc-toc-mobile tocMobile_EIeq"><button type="button" class="clean-btn tocCollapsibleButton_bcUr">On this page</button></div><div class="theme-doc-markdown markdown"><h1>账户管理和权限管理</h1><p>关于 Linux 账户管理和用户权限配置的讲解。</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="内容要点">内容要点<a href="#内容要点" class="hash-link" aria-label="Direct link to 内容要点" title="Direct link to 内容要点">​</a></h2><ul><li>账户实质</li><li>账户文件</li><li>账户设置</li><li>口令管理</li><li>权限表示</li><li>权限设置</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="学习目标">学习目标<a href="#学习目标" class="hash-link" aria-label="Direct link to 学习目标" title="Direct link to 学习目标">​</a></h3><ul><li>熟悉账户配置文件</li><li>学会设置和管理口令</li><li>理解 Linux 系统的权限</li><li>掌握设置基本操作权限</li><li>学会设置特殊权限</li><li>学会设置 ext2/3 的文件扩展属性</li><li>学会设置 FACL 权限</li></ul><h2 class="anchor anchorWithStickyNavbar_J8e2" id="账户管理的相关概念">账户管理的相关概念<a href="#账户管理的相关概念" class="hash-link" aria-label="Direct link to 账户管理的相关概念" title="Direct link to 账户管理的相关概念">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="账户实质">账户实质<a href="#账户实质" class="hash-link" aria-label="Direct link to 账户实质" title="Direct link to 账户实质">​</a></h3><blockquote><p>账户实质上就是一个用户在系统上的标识</p></blockquote><p>系统依据账户来区分每个用户的文件、进程、任务，给每个用户提供特定的工作环境（如用户的工作目录、shell 版本、以及 X-Window 环境的配置等），使每个用户的工作都能独立不受干扰地进行。</p><p>Linux 中的账户包括：</p><ul><li>用户账户</li><li>组账户</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="用户">用户<a href="#用户" class="hash-link" aria-label="Direct link to 用户" title="Direct link to 用户">​</a></h3><p>Linux 系统下的用户账户（简称用户）有两种：</p><ul><li>普通用户账户：在系统上的任务是进行普通工作</li><li>超级用户账户（或管理员账户）：在系统上的任务是对普通用户和整个系统进行管理。</li></ul><p>但不管是哪种用户，都被分配了一个唯一的用户 ID 号（UID）。其中：</p><ul><li>超级用户：UID = 0，GID = 0</li><li>普通用户：UID &gt;= 500</li><li>系统用户（伪用户，不可登录）：0 &lt; UID &lt; 500</li></ul><p>用户名和 UID 被保存在 <code>/etc/passwd</code> 这个文件中。当一个用户登录时，他们被分配了一个主目录和一个运行的程序（通常是 shell）。若无适当权限，用户无法读取、写入或执行彼此的文件。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="组">组<a href="#组" class="hash-link" aria-label="Direct link to 组" title="Direct link to 组">​</a></h3><p>组是用户的集合。</p><p>每个组都被分配了一个唯一的组 ID 号（GID），且组和 GID 被保存在 <code>/etc/group</code> 文件中。</p><p>每个用户都有他们自己的私有组，也都可以被添加到其他组中来获得额外的存取权限。而且组中的所有用户都可以共享属于该组的文件。</p><p>与用户一样，组也有多种类型，包括标准组和私有组。</p><ul><li><p>标准组：标准组可以容纳多个用户。</p><p>若使用标准组，在创建一个新的用户时就应该指定他所属于的组。</p></li><li><p>私有组：私有组中只有用户自己</p><p>当在创建一个新用户时， 若没有指定他所属于的组，系统就会建立一个和该用户同名的私有组，且用户也会被分配到这个私有组中。</p><ul><li>优点：防止新文件归 “公共” 组所有；</li><li>缺点：可能会鼓励创建 “任何人都可以访问” 的文件。</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="用户和组的关系">用户和组的关系<a href="#用户和组的关系" class="hash-link" aria-label="Direct link to 用户和组的关系" title="Direct link to 用户和组的关系">​</a></h3><ol><li>组是用户的集合。</li><li>一个标准组可以容纳多个用户。</li><li>同一个用户可以同属于多个组，这些组可以是私有组，也可以是标准组。</li></ol><p>当一个用户同属于多个组时，将这些组分为：</p><ul><li>主组（初始组）：用户登录系统时的组。</li><li>附加组：可切换的其他组。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="shadow-password">Shadow password<a href="#shadow-password" class="hash-link" aria-label="Direct link to Shadow password" title="Direct link to Shadow password">​</a></h3><p>下面以 Red Hat 的账户管理为例。</p><p>特点：</p><ul><li>默认启用 shadow passwords 功能：<ul><li>/etc/passwd 文件对任何用户均可读，但为了增加系统的安全性， 用户的口令通常用 shadow passwords 保护。</li><li>经过 shadow passwords 保护的账户密码和相关设置信息保存在 /etc/shadow 文件里。 /etc/shadow 只对 root 用户可读。</li><li>默认使用 MD5 算法的用户口令。</li></ul></li><li>一般不会设置组口令。因为绝大多数应用程序不使用组口令。所以建议尽量使用私有组来提高系统安全性。</li><li>管理工具由 shadow-utils 软件包提供。同时不建议管理员直接编辑修改系统账户文件来维护账户。</li></ul><p>账户验证信息文件：</p><table><thead><tr><th>名称</th><th>存储位置</th><th>文件权限</th></tr></thead><tbody><tr><td>口令文件</td><td>/etc/passwd</td><td>-rw-r--r--</td></tr><tr><td>影子口令文件</td><td>/etc/shadow</td><td>-r--------</td></tr><tr><td>组账号文件</td><td>/etc/group</td><td>-rw-r--r--</td></tr><tr><td>组口令文件</td><td>/etc/gshadow</td><td>-r--------</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_J8e2" id="口令文件-etcpasswd">口令文件 /etc/passwd<a href="#口令文件-etcpasswd" class="hash-link" aria-label="Direct link to 口令文件 /etc/passwd" title="Direct link to 口令文件 /etc/passwd">​</a></h4><p>每一个用户一条记录。而每条记录由用冒号间隔的七个字段组成：</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>name</td><td>用户名</td></tr><tr><td>password</td><td>在此文件中的口令是 X，这表示用户的口令是被 /etc/shadow 文件保护的</td></tr><tr><td>uid</td><td>用户的识别号，是一个数字。每个用户的 UID 都是唯一的</td></tr><tr><td>gid</td><td>用户的组的识别号，也是一个数字。每个用户账户在建立好后都会有一个主组。主组相同的账户其 GID 相同。</td></tr><tr><td>description</td><td>用户的个人资料，包括地址、电话等信息</td></tr><tr><td>home</td><td>用户的主目录，通常在 /home 下，目录名和账户名相同</td></tr><tr><td>shell</td><td>用户登录后启动的 shell，默认是 /bin/bash</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_J8e2" id="影子口令文件-etcshadow">影子口令文件 /etc/shadow<a href="#影子口令文件-etcshadow" class="hash-link" aria-label="Direct link to 影子口令文件 /etc/shadow" title="Direct link to 影子口令文件 /etc/shadow">​</a></h4><p>每一个用户一条记录。且每条记录由用冒号间隔的九个字段组成：</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>用户名</td><td>用户登录名</td></tr><tr><td>口令</td><td>用户的密码，是加密过的（MD5）</td></tr><tr><td>最后一次修改的时间</td><td>从 1970 年 1 月 1 日起，到用户最后一次更改密码的天数</td></tr><tr><td>最小时间间隔</td><td>从 1970 年 1 月 1 日起，到用户应该更改密码的天数</td></tr><tr><td>最大时间间隔</td><td>从 1970 年 1 月 1 日起，到用户必须更改密码的天数</td></tr><tr><td>警告时间</td><td>在用户密码过期之前多少天提醒用户更新</td></tr><tr><td>不活动时间</td><td>在用户密码过期之后到禁用账户的天数</td></tr><tr><td>失效时间</td><td>从 1970 年 1 月 1 日起，到账户被禁用的天数</td></tr><tr><td>标志</td><td>保留位</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_J8e2" id="组账号文件-etcgroup">组账号文件 /etc/group<a href="#组账号文件-etcgroup" class="hash-link" aria-label="Direct link to 组账号文件 /etc/group" title="Direct link to 组账号文件 /etc/group">​</a></h4><p>每一个组一条记录。每条记录由用冒号间隔的四个字段组成：</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>组名</td><td>这是用户登录系统时的默认组名，它在系统中是唯一的</td></tr><tr><td>口令</td><td>组口令，由于安全性原因，已不使用该字段保存口令，用“x”占位</td></tr><tr><td>组 ID</td><td>是一个整数，系统内部用它来标识组</td></tr><tr><td>组内用户列表</td><td>属于该组的所有用户名表，列表中多个用户间用“,”分隔</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_J8e2" id="组口令文件-etcgshadow">组口令文件 /etc/gshadow<a href="#组口令文件-etcgshadow" class="hash-link" aria-label="Direct link to 组口令文件 /etc/gshadow" title="Direct link to 组口令文件 /etc/gshadow">​</a></h4><p>每一个组一条记录。每条记录由用冒号间隔的四个字段组成：</p><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>组名</td><td>组名称，该字段与 group 文件中的组名称对应</td></tr><tr><td>加密的组口令</td><td>用于保存已加密的口令</td></tr><tr><td>组的管理员账号</td><td>管理员有权对该组添加删除账号</td></tr><tr><td>组内用户列表</td><td>属于该组的用户成员列表，列表中多个用户间用“,”分隔</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="验证账号文件的一致性">验证账号文件的一致性<a href="#验证账号文件的一致性" class="hash-link" aria-label="Direct link to 验证账号文件的一致性" title="Direct link to 验证账号文件的一致性">​</a></h3><p>Red Hat 不建议管理员直接编辑修改系统账户文件来维护账户。但若用户直接编辑了账户文件， 建议使用账号文件的一致性检测命令：</p><ul><li><p>命令 <code>pwck</code> ：验证用户账号文件，认证信息的完整性。</p><p>该命令检测文件 /etc/passwd 和 /etc/shadow 的每行中字段的格式和值是否正确。</p></li><li><p>命令 <code>grpck</code>：验证组账号文件，认证信息的完整性。</p><p>该命令检测文件 /etc/group 和 /etc/gshadow 的每行中字段的格式和值是否正确。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="用户默认环境配置及模板">用户默认环境配置及模板<a href="#用户默认环境配置及模板" class="hash-link" aria-label="Direct link to 用户默认环境配置及模板" title="Direct link to 用户默认环境配置及模板">​</a></h3><p>用户默认配置文件：</p><ul><li>/etc/login.defs</li><li>/etc/default/useradd</li></ul><p>新用户基本信息：</p><ul><li>/etc/skel</li></ul><p>如果手工创建用户，则需复制该目录到用户主目录。</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="用户和组管理">用户和组管理<a href="#用户和组管理" class="hash-link" aria-label="Direct link to 用户和组管理" title="Direct link to 用户和组管理">​</a></h2><p>用户管理：</p><ul><li>useradd</li><li>usermod</li><li>userdel</li></ul><p>组管理：</p><ul><li>groupadd</li><li>groupmod</li><li>groupdel</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="用户管理">用户管理<a href="#用户管理" class="hash-link" aria-label="Direct link to 用户管理" title="Direct link to 用户管理">​</a></h3><h4 class="anchor anchorWithStickyNavbar_J8e2" id="添加用户账号useradd">添加用户账号（useradd）<a href="#添加用户账号useradd" class="hash-link" aria-label="Direct link to 添加用户账号（useradd）" title="Direct link to 添加用户账号（useradd）">​</a></h4><p>格式：<code>useradd [&lt;选项&gt;] &lt;用户名&gt;</code></p><p>常用选项：</p><ul><li><code>-g group</code>：指定新用户的主（私有）组。</li><li><code>-G group</code>：指定新用户的附加组。</li><li><code>-d directory</code>：指定新用户的自家目录。</li><li><code>-s shell</code>：定新用户使用的 Shell，默认为 bash。</li><li><code>-e expire</code>：指定用户的登录失效时间，例如：08/10/2001</li><li><code>-M</code>：不建立新用户的自家目录。</li></ul><p>useradd 命令添加用户过程：</p><ol><li><p>编辑账户验证信息文件</p><ul><li>/etc/passwd, /etc/shadow</li><li>/etc/group, /etc/gshadow</li></ul></li><li><p>创建主目录 <code>/home/&lt;username&gt;</code>：</p><p>根据骨架目录（Skeleton Directory）的模板文件，即 /etc/skel/ 的内容填充用户主目录</p></li><li><p>设置权限和拥有者</p></li></ol><h4 class="anchor anchorWithStickyNavbar_J8e2" id="设置用户口令passwd">设置用户口令（passwd）<a href="#设置用户口令passwd" class="hash-link" aria-label="Direct link to 设置用户口令（passwd）" title="Direct link to 设置用户口令（passwd）">​</a></h4><p>命令格式：<code>passwd［＜用户账号名＞]</code></p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 设置用户自己的口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># root用户设置他人的口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> user1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 例一：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -g group1 -e </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">/31/2011 user1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> user1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 例二：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -G staff tom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> tom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 例三：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -G ftpgrp -d /var/ftp2 -s /sbin/nologin -M ftp1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> ftp1</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>显示 useradd 命令参数的默认值：</p><ul><li>使用命令 <code>useradd -D</code></li><li>从文件 /etc/default/useradd 中读取</li></ul><p>更改 useradd 命令参数的默认值：</p><ul><li>格式：<code>useradd -D [-g group] [-b base] [-s shell] [-e expire]</code></li><li>如：</li></ul><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">useradd</span><span class="token plain"> -D -s /bin/ksh</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_J8e2" id="修改用户账号usermod-命令">修改用户账号（usermod 命令）<a href="#修改用户账号usermod-命令" class="hash-link" aria-label="Direct link to 修改用户账号（usermod 命令）" title="Direct link to 修改用户账号（usermod 命令）">​</a></h4><p>格式：<code>usermod 用户帐号 &lt;参数&gt;</code></p><p>参数：</p><ul><li><code>-c &lt;备注&gt;</code>：修改用户帐号的备注文字。</li><li><code>-d 登入目录&gt;</code>：修改用户登入时的目录。</li><li><code>-e &lt;有效期限&gt;</code>：修改帐号的有效期限。</li><li><code>-f &lt;缓冲天数&gt;</code>：修改在密码过期后多少天即关闭该帐号。</li><li><code>-g &lt;群组&gt;</code>：修改用户所属的群组。</li><li><code>-G &lt;群组&gt;</code>：修改用户所属的附加群组。</li><li><code>-l &lt;帐号名称&gt;</code>：修改用户帐号名称。</li><li><code>-L</code>：锁定用户密码，使密码无效。</li><li><code>-s &lt;shell&gt;</code>：修改用户登入后所使用的 shell。</li><li><code>-u &lt;uid&gt;</code>：修改用户 ID。</li><li><code>-U</code>：解除密码锁定。</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 1、将 newuser2 添加到组 staff 中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -G staff newuser2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2、修改 newuser 的用户名为 newuser1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -l newuser1 newuser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3、锁定账号 newuser1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -L newuser1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4、解除对 newuser1 的锁定</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -U newuser1</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_J8e2" id="删除用户账号userdel">删除用户账号（userdel）<a href="#删除用户账号userdel" class="hash-link" aria-label="Direct link to 删除用户账号（userdel）" title="Direct link to 删除用户账号（userdel）">​</a></h4><p>格式：<code>userdel [&lt;-r&gt;] &lt;用户名&gt;</code> 选项：</p><ul><li>-<!-- -->r：用于删除用户的宿主目录</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">userdel</span><span class="token plain"> ftp1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">userdel</span><span class="token plain"> –r user1</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="组管理">组管理<a href="#组管理" class="hash-link" aria-label="Direct link to 组管理" title="Direct link to 组管理">​</a></h3><h4 class="anchor anchorWithStickyNavbar_J8e2" id="添加组账号groupadd-命令">添加组账号（groupadd 命令）<a href="#添加组账号groupadd-命令" class="hash-link" aria-label="Direct link to 添加组账号（groupadd 命令）" title="Direct link to 添加组账号（groupadd 命令）">​</a></h4><p>格式：<code>groupadd [&lt;参数&gt;] &lt;组账号名&gt;</code> 参数：</p><ul><li>-<!-- -->r：用于创建系统组账号（GID 小于 500 ）</li><li>-<!-- -->g：用于指定 GID</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">groupadd</span><span class="token plain"> mygroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">groupadd</span><span class="token plain"> -r sysgroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">groupadd</span><span class="token plain"> -g </span><span class="token number" style="color:#36acaa">888</span><span class="token plain"> group2</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_J8e2" id="修改组账号groupmod-命令">修改组账号（groupmod 命令）<a href="#修改组账号groupmod-命令" class="hash-link" aria-label="Direct link to 修改组账号（groupmod 命令）" title="Direct link to 修改组账号（groupmod 命令）">​</a></h4><p>格式：<code>groupmod [&lt;参数&gt;] &lt;组账号名&gt;</code></p><p>参数：</p><ul><li>-<!-- -->g：改变组账号的 GID ，组账号名保持不变。</li><li>-<!-- -->n：改变组账号名。</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">groupmod</span><span class="token plain"> -g </span><span class="token number" style="color:#36acaa">503</span><span class="token plain"> mygroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">groupmod</span><span class="token plain"> –n newgroup mygroup</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_J8e2" id="删除组账号groupdel-命令">删除组账号（groupdel 命令）<a href="#删除组账号groupdel-命令" class="hash-link" aria-label="Direct link to 删除组账号（groupdel 命令）" title="Direct link to 删除组账号（groupdel 命令）">​</a></h4><p>格式：<code>groupdel &lt;组账号名&gt;</code> 如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">groupdel</span><span class="token plain"> mygroup</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意：</p><ul><li>被删除的组账号必须存在</li><li>当有用户使用组账号作为私有组时不能删除</li><li>与用户名同名的私有组账号在使用 userdel 命令删除用户时被同时删除，无需使用 groupdel 命令</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="组成员管理">组成员管理<a href="#组成员管理" class="hash-link" aria-label="Direct link to 组成员管理" title="Direct link to 组成员管理">​</a></h3><p>向标准组中添加用户：</p><ul><li><code>gpasswd -a &lt;用户账号名&gt; &lt;组账号名&gt;</code></li><li><code>usermod -G &lt;组账号名&gt; &lt;用户账号名&gt;</code></li></ul><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">gpasswd -a user1 staff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">usermod</span><span class="token plain"> -G staff user1</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>xxxxxxxxxx10 1# 查看指定用户或组的 quota 设置 2quota <!-- -->[<!-- -->-vl] <!-- -->[<!-- -->-u ] 3quota <!-- -->[<!-- -->-vl] <!-- -->[<!-- -->-g ] 4quota -q5​6# 显示文件系统的磁盘限额汇总信息 7# 显示指定文件系统的磁盘限额汇总信息 8repquota <!-- -->[<!-- -->-ugv] filesystem... 9# 显示所有文件系统的磁盘限额汇总信息 10repquota <!-- -->[<!-- -->-auv] bash</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">gpasswd -d user1 staff</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_J8e2" id="批量用户管理">批量用户管理<a href="#批量用户管理" class="hash-link" aria-label="Direct link to 批量用户管理" title="Direct link to 批量用户管理">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="批量用户管理工具">批量用户管理工具<a href="#批量用户管理工具" class="hash-link" aria-label="Direct link to 批量用户管理工具" title="Direct link to 批量用户管理工具">​</a></h3><p>成批添加／更新一组账户：newusers 成批更新用户的口令：chpasswd 批量生成安全的口令：pwgen 或 secpwgen（由 RPMForge 仓库提供）</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="newusers-命令">newusers 命令<a href="#newusers-命令" class="hash-link" aria-label="Direct link to newusers 命令" title="Direct link to newusers 命令">​</a></h3><p>格式：<code>newusers &lt;filename&gt;</code></p><blockquote><p>filename 的格式与 /etc/passwd 一致</p></blockquote><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">vi</span><span class="token plain"> userfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user1:x:1001:1001::/home/user1:/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user2:x:1002:1002::/home/user2:/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ftpuser1:x:2001:2001::/home/ftpuser1:/sbin/nologin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ftpuser2:x:2002:2002::/home/ftpuser2:/sbin/nologin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">newusers userfile.txt</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="chpasswd-命令">chpasswd 命令<a href="#chpasswd-命令" class="hash-link" aria-label="Direct link to chpasswd 命令" title="Direct link to chpasswd 命令">​</a></h3><p>格式：<code>chpasswd &lt;filename&gt;</code></p><p>其中 filename 每一行的格式：<code>username:password</code></p><p>而 username 必须是系统上已存在的用户</p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">vi</span><span class="token plain"> userpwdfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> userpwdfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userpwdfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user1:123456</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user2:passwd</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ftpuser1:123qaz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ftpuser2:xsw321</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或者直接使用管道连接</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userpwdfile.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> chpasswd</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="pwgen-命令">pwgen 命令<a href="#pwgen-命令" class="hash-link" aria-label="Direct link to pwgen 命令" title="Direct link to pwgen 命令">​</a></h3><p>格式：<code>pwgen [选项] [口令长度] [口令个数]</code></p><p>默认的口令长度为 8；默认生成的口令个数为 160 个。</p><p>选项：</p><ul><li><code>-c</code>：至少包含一个大写字母</li><li><code>-n</code>：至少包含一个数字</li><li><code>-y</code>：至少包含一个非字母和数字的特殊字符</li><li><code>-s</code>：生成完全随机的安全口令</li><li><code>-1</code>：每行只显示一个口令，使用该参数通常不省略 <code>[口令长度] [口令个数]</code>。如果省略 <code>[口令长度] [口令个数]</code> 就只生成一个口令。</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">pwgen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen  </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -1 </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -sy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -ns </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -nsy </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -nsy1 </span><span class="token number" style="color:#36acaa">12</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 pwgen 命令生成 chpasswd 命令所需的口令文件：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userfile.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user1:x:1001:1001::/home/user1:/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># user2:x:1002:1002::/home/user2:/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">: -f </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> userfile.txt </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pwdtemp1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或者使用：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cut</span><span class="token plain"> -d </span><span class="token string" style="color:#e3116c">&quot;:&quot;</span><span class="token plain"> -f </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> userfile.txt </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pwdtemp1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -cn1 </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">wc</span><span class="token variable" style="color:#36acaa"> -l </span><span class="token variable operator" style="color:#393A34">&lt;</span><span class="token variable" style="color:#36acaa"> userfile.txt</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pwdtemp2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># wc命令用于获取文本文件中的文本行数。命令亦可写作：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pwgen -cn1 </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">wc</span><span class="token variable" style="color:#36acaa"> -l </span><span class="token variable operator" style="color:#393A34">&lt;</span><span class="token variable" style="color:#36acaa"> userfile.txt</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> pwdtemp2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 文本拼接</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">paste</span><span class="token plain"> -d “:” pwdtemp1 pwdtemp2 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> userpwd.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设置密码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> userpwdfile.txt </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> chpasswd</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_J8e2" id="口令维护和口令时效">口令维护和口令时效<a href="#口令维护和口令时效" class="hash-link" aria-label="Direct link to 口令维护和口令时效" title="Direct link to 口令维护和口令时效">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="口令维护">口令维护<a href="#口令维护" class="hash-link" aria-label="Direct link to 口令维护" title="Direct link to 口令维护">​</a></h3><p>即禁用、恢复和删除用户口令。</p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 禁用用户账户口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">用户账号名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看用户账户口令状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> -S </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">用户账号名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 恢复用户账户口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> -u </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">用户账号名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 清除用户账户口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> -d </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">用户账号名</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="口令时效">口令时效<a href="#口令时效" class="hash-link" aria-label="Direct link to 口令时效" title="Direct link to 口令时效">​</a></h3><p>口令时效是系统管理员用来防止机构内不良口令的一种技术。</p><p>防止口令被攻击的方法就是要经常地改变口令；而强制用户在一段时间之后更改口令的机制称为口令时效。</p><p>在默认状况下，口令不会过期。但事实上，强制口令失效是强大安全策略的一部分。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="设置新添用户的口令时效">设置新添用户的口令时效<a href="#设置新添用户的口令时效" class="hash-link" aria-label="Direct link to 设置新添用户的口令时效" title="Direct link to 设置新添用户的口令时效">​</a></h3><p>修改 /etc/login.defs 的相关配置参数：</p><table><thead><tr><th>参数</th><th>配置解释</th></tr></thead><tbody><tr><td>PASS_MAX_DAYS</td><td>设定在多少天后要求用户修改口令。默认口令时效的天数为 99999，即关闭了口令时效。明智的设定一般是 60 天（2 个月）强制更改一次口令。</td></tr><tr><td>PASS_MIN_DAYS</td><td>设定在本次口令修改后，至少要经过多少天后才允许更改口令。</td></tr><tr><td>PASS_MIN_LEN</td><td>设定口令的最小字符数。</td></tr><tr><td>PASS_WARN_AGE</td><td>设定在口令失效前多少天开始通知用户更改口令（一般在用户刚刚登录系统时就会收到警告通知）。</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="设置已存在用户的口令时效chage-命令">设置已存在用户的口令时效（chage 命令）<a href="#设置已存在用户的口令时效chage-命令" class="hash-link" aria-label="Direct link to 设置已存在用户的口令时效（chage 命令）" title="Direct link to 设置已存在用户的口令时效（chage 命令）">​</a></h3><p>格式：<code>chage [选项] [用户登录名]</code></p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看用户jason当前的口令时效信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chage -l jason</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 使用户jason下次登录之后修改口令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chage -d </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> jason</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 用户 jason 两天内不能更改口令，且口令最长的存活期为 30 天，并在口令过期前 5 天通知用户</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chage -m </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> -M </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> -W </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> jason</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="用户切换命令">用户切换命令<a href="#用户切换命令" class="hash-link" aria-label="Direct link to 用户切换命令" title="Direct link to 用户切换命令">​</a></h3><ol><li>su -<ul><li>直接切换为超级用户</li><li>普通用户要切换为超级用户必须知道超级用户的口令</li><li>适用于系统中只有单个系统管理员的情况</li></ul></li><li>sudo<ul><li>直接使用 sudo 命令前缀执行系统管理命令</li><li>执行系统管理命令时无需知道超级用户的口令，使用普通用户自己的口令即可</li><li>由于执行系统管理命令时无需知晓超级用户口令，所以适用于系统中有多个系统管理员的情况，因为这样不会泄露超级用户口令。当然系统只有单个系统管理员时也可以使用。</li></ul></li></ol><p>root 账户键入 visudo 即可进入 sudo 配置，或者 <code>vim /etc/sudoers</code>。使用 visudo 进行 sudo 配置，将会得到很多提示。</p><p>按 yyp 键复制并在粘贴在下一行，在这一行的 root 处将 root 替换为你所需要添加用户的账户名，比如 user1，结果就是：</p><div class="language-text codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-text codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">root   ALL=(ALL)   ALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">user1   ALL=(ALL)   ALL</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="账户相关命令">账户相关命令<a href="#账户相关命令" class="hash-link" aria-label="Direct link to 账户相关命令" title="Direct link to 账户相关命令">​</a></h3><table><thead><tr><th>命令</th><th>解释</th></tr></thead><tbody><tr><td>id</td><td>显示用户当前的 uid、gid 和用户所属的组列表</td></tr><tr><td>groups</td><td>显示指定用户所属的组列表</td></tr><tr><td>whoami</td><td>显示当前用户的名称</td></tr><tr><td>w/who</td><td>显示登录用户及相关信息</td></tr><tr><td>newgrp</td><td>用于转换用户的当前组到指定的组账号，用户必须属于该组才可以正确执行该命令</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="id-命令">id 命令<a href="#id-命令" class="hash-link" aria-label="Direct link to id 命令" title="Direct link to id 命令">​</a></h3><p>说明：查看账户的 uid 和 gid 及所属分组</p><p>格式：<code>id [-gGnru] [--help] [--version] [用户名称]</code></p><p>参数：</p><ul><li><code>-g</code> 或 <code>--group</code>：显示用户所属群组的 ID。</li><li><code>-G</code> 或 <code>--groups</code>：显示用户所属附加群组的 ID。</li><li><code>-n</code> 或 <code>--name</code>：显示用户，所属群组或附加群组的名称。</li><li><code>-r</code> 或 <code>--real</code>：显示实际 ID。</li><li><code>-u</code> 或 <code>--user</code>：显示用户 ID。</li></ul><p>说明：id 会显示用户以及所属群组的实际与有效 ID。若两个 ID 相同，则仅显示实际 ID。若仅指定用户名称，则显示目前用户的 ID。</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="文件和目录的基本权限">文件和目录的基本权限<a href="#文件和目录的基本权限" class="hash-link" aria-label="Direct link to 文件和目录的基本权限" title="Direct link to 文件和目录的基本权限">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="权限概述">权限概述<a href="#权限概述" class="hash-link" aria-label="Direct link to 权限概述" title="Direct link to 权限概述">​</a></h3><p>Linux 是多用户的操作系统，允许多个用户同时在系统上登录和工作。</p><p>为了确保系统和用户的安全采取了如下安全措施：</p><ul><li>通过 UID/GID 确定每个用户在登录系统后都做了些什么</li><li>通过 UID/GID 来区别不同用户所建立的文件或目录</li><li>每个文件或目录都属于一个 UID 和一个 GID</li><li>每个进程都使用一个 UID 和一个或多个 GID 来运行</li><li>通常由被运行进程的用户决定</li><li>超级用户具有一切权限，无需特殊说明</li><li>普通用户只能不受限制的操作主目录及其子目录下的所有文件，对系统中其他目录/文件的访问受到限制</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="三种基本权限">三种基本权限<a href="#三种基本权限" class="hash-link" aria-label="Direct link to 三种基本权限" title="Direct link to 三种基本权限">​</a></h3><table><thead><tr><th>权限</th><th>描述字符</th><th>对文件的含义</th><th>对目录的含义</th></tr></thead><tbody><tr><td>读权限</td><td>r</td><td>可以读取文件的内容</td><td>可以列出目录中的文件列表</td></tr><tr><td>写权限</td><td>w</td><td>可以修改或删除文件</td><td>可以在该目录中创建或删除文件或子目录</td></tr><tr><td>执行权限</td><td>x</td><td>可以执行该文件</td><td>可以使用 cd 命令进入该目录</td></tr></tbody></table><ul><li>目录上有执行权限（x），表示可以进入该目录或穿越它进入更深层次的子目录。</li><li>目录上只有执行权限（x），但目录没有读权限（无法访问文件列表），要访问该目录下的有读权限的文件，必须知道文件名才可以访问。</li><li>目录上只有执行权限（x），不能列出目录列表也不能删除该目录。</li><li>目录上执行权限和读权限的组合（rx），表示可以进入目录并列出目录列表</li><li>目录上执行权限和写权限的组合（rwx），表示可以在目录中创建、删除和重命名文件（但不能列出文件列表）。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="分配三种基本权限">分配三种基本权限<a href="#分配三种基本权限" class="hash-link" aria-label="Direct link to 分配三种基本权限" title="Direct link to 分配三种基本权限">​</a></h3><table><thead><tr><th>文件/目录使用者</th><th>权限名</th><th>权限分配（用途）</th><th>权限的优先顺序</th></tr></thead><tbody><tr><td>属主</td><td>属主 user</td><td>限制文件或目录的创建者</td><td>UID 匹配</td></tr><tr><td>同组人</td><td>组 group</td><td>限制文件或目录所属组的成员</td><td>UID 不匹配但 GID 匹配</td></tr><tr><td>其他人</td><td>其他用户 other</td><td>限制非属主或所属组的能访问该文件或目录的其他人员</td><td>都不匹配</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="查看文件目录的权限">查看文件/目录的权限<a href="#查看文件目录的权限" class="hash-link" aria-label="Direct link to 查看文件/目录的权限" title="Direct link to 查看文件/目录的权限">​</a></h3><p>通过给三类用户分配三种基本权限，就产生了文件或目录的 9 个基本权限位。如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 总计 12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -rw-rw-r--   1   osmond   family   0   06-16   20:43   abc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># drwxr-xr-x   2   osmond   family   4096   06-16   20:43   docs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -rw-rw-r--   1   osmond   osmond   1155   06-16   20:44   mylist.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># drwxr-xr-x   3   osmond   osmond   4096   05-16   13:32   nobp</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>每一列表示的内容如图：</p><p><img loading="lazy" alt="image-20221018221355871" src="/en/assets/images/image-20221018221355871-e5c3ad9a3cea4756ee444b7236f892ba.png" width="842" height="246" class="img_ABpA"></p><blockquote><p>其中 <code>-</code> 表示无权限。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_J8e2" id="文件目录的权限">文件/目录的权限<a href="#文件目录的权限" class="hash-link" aria-label="Direct link to 文件/目录的权限" title="Direct link to 文件/目录的权限">​</a></h3><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -l docs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">   osmond   family   </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain">   06-16   </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">:43   docs</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="image-20221018234206639" src="/en/assets/images/image-20221018234206639-1b606fb3ae83103043b1138438a6ad60.png" width="761" height="182" class="img_ABpA"></p><p>在显示的结果中，第一个字段的第 2 ～ 10 个字符是用来表示权限。</p><p>这 9 个字符每 3 个一组，组成 3 套 权限控制：</p><ul><li>第一套控制文件所有者的访问权限</li><li>第二套控制所有者所在用户组的其他成员的访问权限</li><li>第三套控制系统其他用户的访问权限</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="常见的权限字符串及其含义">常见的权限字符串及其含义<a href="#常见的权限字符串及其含义" class="hash-link" aria-label="Direct link to 常见的权限字符串及其含义" title="Direct link to 常见的权限字符串及其含义">​</a></h3><table><thead><tr><th>字符串</th><th>八进制数值</th><th>说明</th></tr></thead><tbody><tr><td>-rw-------</td><td>600</td><td>只有属主才有读取和写入的权限。</td></tr><tr><td>-rw-r--r--</td><td>644</td><td>只有属主才有读取和写入的权限；同组人和其他人只有读取的权限。</td></tr><tr><td>-rwx------</td><td>700</td><td>只有属主才有读取、写入、和执行的权限。</td></tr><tr><td>-rwxr-xr-x</td><td>755</td><td>属主有读取、写入、和执行的权限；同组人和其他人只有读取和执行的权限。</td></tr><tr><td>-rwx--x--x</td><td>711</td><td>属主有读取、写入、和执行权限；同组人和其他人只有执行权限。</td></tr><tr><td>-rw-rw-rw-</td><td>666</td><td>每个人都能够读取和写入文件。</td></tr><tr><td>-rwxrwxrwx</td><td>777</td><td>每个人都能够读取、写入、和执行。</td></tr><tr><td>drwx------</td><td>700</td><td>只有属主能在目录中读取、写入。</td></tr><tr><td>drwxr-xr-x</td><td>755</td><td>每个人都能够读取目录，但是其中的内容却只能被属主改变。</td></tr></tbody></table><blockquote><p>每个用户都拥有自己的专属目录（主目录），通常放置在 /home 目录下，这些专属目录的默认权限通常为：<code>drwx------</code></p></blockquote><h3 class="anchor anchorWithStickyNavbar_J8e2" id="与权限相关的命令">与权限相关的命令<a href="#与权限相关的命令" class="hash-link" aria-label="Direct link to 与权限相关的命令" title="Direct link to 与权限相关的命令">​</a></h3><ul><li>chmod：改变文件或目录的权限</li><li>chown：改变文件或目录的属主（所有者）</li><li>chgrp：改变文件或目录所属的组</li><li>umask：设置文件的缺省生成掩码</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="修改文件目录的权限chmod">修改文件/目录的权限（chmod）<a href="#修改文件目录的权限chmod" class="hash-link" aria-label="Direct link to 修改文件/目录的权限（chmod）" title="Direct link to 修改文件/目录的权限（chmod）">​</a></h3><p>用途：更改已有文件或目录的访问权限</p><p>命令使用方法：</p><ul><li><p>文字设定法：使用字母和操作符表达式来修改或设定文件的访问权限</p><p>格式：<code>chmod [-R] &lt;文字模式&gt; &lt;文件或目录名&gt;</code></p></li><li><p>数值设定法：使用八进制数字来设定文件的访问权限</p><p>格式：<code>chmod [-R] &lt;八进制模式&gt; &lt;文件或目录名&gt;</code></p></li></ul><blockquote><p><code>-R</code> 选项表示对目录中的所有文件或子目录进行递归操作。</p></blockquote><h4 class="anchor anchorWithStickyNavbar_J8e2" id="chmod-的文字设定法">chmod 的文字设定法<a href="#chmod-的文字设定法" class="hash-link" aria-label="Direct link to chmod 的文字设定法" title="Direct link to chmod 的文字设定法">​</a></h4><p>格式：<code>chmod [who] [ + / - / = ] [permission] 文件或目录名</code></p><p>参数：</p><ul><li><code>[who]</code>：操作对象，包含：<ul><li>u，即属主（user）</li><li>g，即同组（group）</li><li>o，即其他（other）</li><li>a，即所有（all）</li></ul></li><li><code>[ + / - / = ]</code>：操作符号，包含：<ul><li>+<!-- -->，添加某权限</li><li>-<!-- -->，删除某权限</li><li>\=，直接赋予某权限并取消其他所有权限</li></ul></li><li><code>[permission]</code>：访问权限，包含：<ul><li>r，读</li><li>w，写</li><li>x，执行</li><li>-<!-- -->，无权限</li></ul></li></ul><p>在一个命令行中可给出多个权限模式，其间用逗号间隔。</p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> u+rw myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> a+rx,u+w myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> u+rwx,g+rx,o+rx myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> a+rwx ,g-w,o-w myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">a</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rwx myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">go</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rx myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> u-wx,go-x myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> a+x myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +r myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod a+r myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +x myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod a+x myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> +w myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod u+w myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">r myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod a=r myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain">w myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod u=w myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">o</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 等价于：chmod o=- myfile</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">u</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rw,g</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">,o</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> projects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> -R </span><span class="token assign-left variable" style="color:#36acaa">u</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">rwx,go</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> projects</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_J8e2" id="chmod-的数字设定法">chmod 的数字设定法<a href="#chmod-的数字设定法" class="hash-link" aria-label="Direct link to chmod 的数字设定法" title="Direct link to chmod 的数字设定法">​</a></h4><p>格式：<code>chmod n1n2n3 文件或目录名</code></p><p>使用三个数字模式来表示，分别代表用户（n1）、同组用户（n2）和其它用户（n3）的访问权限。</p><p>每个数字模式（n1|n2|n3）由不同权限所对应的数字相加得到一个表示访问权限的八进制数字。</p><table><thead><tr><th>权限</th><th>对应数字</th></tr></thead><tbody><tr><td>r</td><td>4</td></tr><tr><td>w</td><td>2</td></tr><tr><td>x</td><td>1</td></tr><tr><td>-</td><td>0</td></tr></tbody></table><p>权限转换如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">-rw-r--r--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 转换为：644</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx--x--x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 转换为：711</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwx------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 转换为：700</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-xr-x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 转换为：755</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>设定代码如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 设定文件 myname.txt 的权限属性为：-rw-r--r--</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">644</span><span class="token plain"> myname.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设定文件 myname.txt 的权限属性为：-rwxr-x---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">750</span><span class="token plain"> myname.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 设定目录 mydata 的权限属性为：drwx------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"> mydata/</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="改变文件目录属主或组chownchgrp">改变文件/目录属主或组（chown、chgrp）<a href="#改变文件目录属主或组chownchgrp" class="hash-link" aria-label="Direct link to 改变文件/目录属主或组（chown、chgrp）" title="Direct link to 改变文件/目录属主或组（chown、chgrp）">​</a></h3><ul><li>只有 root 用户才能改变文件的所有者</li><li>只有 root 用户或所有者才能改变文件所属的组</li></ul><p>用 chown 命令改变属主、组，格式为：</p><p><code>chown [-R] &lt;用户名[&lt;.|:&gt;组名]&gt; &lt;文件｜目录&gt;</code></p><p>chgrp 被用来改变所属组，格式为：</p><p><code>chgrp [-R] &lt;组名&gt; &lt;文件｜目录&gt;</code></p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> soft myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chgrp</span><span class="token plain"> softgrp myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> .softgrp myfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R soft mydir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chgrp</span><span class="token plain"> softgrp mydir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R :softgrp mydir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chown</span><span class="token plain"> -R soft.softgrp mydir</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="设置生成文件目录时的默认权限">设置生成文件/目录时的默认权限<a href="#设置生成文件目录时的默认权限" class="hash-link" aria-label="Direct link to 设置生成文件/目录时的默认权限" title="Direct link to 设置生成文件/目录时的默认权限">​</a></h3><ul><li>创建新文件或新目录时，系统都会为它们指定默认的访问权限，这个缺省的访问权限就由 umask 值来决定。</li><li>用户可以使用 umask 命令设置文件的默认生成掩码。默认生成掩码告诉系统当创建一个文件或目录时<strong>不应该</strong>赋予其哪些权限。</li><li>系统不允许用户在创建一个普通文件时就赋予它可执行权限，必须在创建后用 chmod 修改。目录则允许设定可执行权限。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="umask-命令">umask 命令<a href="#umask-命令" class="hash-link" aria-label="Direct link to umask 命令" title="Direct link to umask 命令">​</a></h3><p>格式：</p><p>查看当前 umask 值：<code>umask [-S]</code></p><p>修改当前 umask 值：<code>umask u1u2u3</code></p><ul><li>u1 表示的是不允许属主有的权限</li><li>u2 表示的是不允许同组人有的权限</li><li>u3 表示的是不允许其他人有的权限</li></ul><p>RHEL/CentOS 默认的 umask 值：</p><ul><li>普通用户的 umask 是 002</li><li>root 用户的 umask 是 022</li></ul><h4 class="anchor anchorWithStickyNavbar_J8e2" id="umask-值与文件目录权限">umask 值与文件/目录权限<a href="#umask-值与文件目录权限" class="hash-link" aria-label="Direct link to umask 值与文件/目录权限" title="Direct link to umask 值与文件/目录权限">​</a></h4><p>numask 值与新建文件/目录的权限对应表：</p><table><thead><tr><th>umask 值</th><th>新建目录的访问权限</th><th>新建文件的访问权限</th></tr></thead><tbody><tr><td>022</td><td>777 - 022 = 755</td><td>666 - 022 = 644</td></tr><tr><td>027</td><td>777 - 027 = 750</td><td>666 - 027 = 640</td></tr><tr><td>045</td><td>777 - 045 = 732</td><td>666 - 045 = 622</td></tr><tr><td>006</td><td>777 - 006 = 771</td><td>666 - 006 = 660</td></tr><tr><td>007</td><td>777 - 007 = 770</td><td>666 - 007 = 660</td></tr></tbody></table><p>对于文件：如果 umask 的部分位或全部位为奇数，那么，在对应为奇数的文件权限位计算结果分别再加 1 就是最终文件权限值。</p><h4 class="anchor anchorWithStickyNavbar_J8e2" id="设置-umask-值的方法">设置 umask 值的方法<a href="#设置-umask-值的方法" class="hash-link" aria-label="Direct link to 设置 umask 值的方法" title="Direct link to 设置 umask 值的方法">​</a></h4><ul><li><p>使用 umask 命令临时设置</p></li><li><p>在 Shell 环境配置文件中设置（RHEL/CentOS 默认在 /etc/bashrc 中设置）</p></li><li><p>在 <!-- -->~<!-- -->/.bashrc 中重新设置：</p><p>在 /etc/fstab 的文件系统挂装参数中指定</p></li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在 /etc/fstab 的挂装选项中加入 umask 值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/sda10  /home  ext3  noauto,umask</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">022,iocharset</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">cp936,ro,users  </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_J8e2" id="三种特殊权限">三种特殊权限<a href="#三种特殊权限" class="hash-link" aria-label="Direct link to 三种特殊权限" title="Direct link to 三种特殊权限">​</a></h2><p>可执行文件的特殊权限：</p><ul><li>suid：使用命令的所属用户的权限来运行，而不是命令执行者的权限</li><li>sgid：使用命令的组权限来运行</li></ul><p>目录的特殊权限：</p><ul><li>sgid：在设置了 sgid 权限的目录中创建的文件会具备该目录的组权限</li><li>sticky-bit：在带有粘滞位的目录中的文件只能被文件的所属用户和 root 用户删除，不管该目录的写入权限是如何设置的</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="特殊权限的文字表示方法">特殊权限的文字表示方法<a href="#特殊权限的文字表示方法" class="hash-link" aria-label="Direct link to 特殊权限的文字表示方法" title="Direct link to 特殊权限的文字表示方法">​</a></h3><p>SUID 和 SGID 用 s 表示；Sticky-bit 用 t 表示。</p><ul><li>SUID：占用属主的 x 位置来表示</li><li>SGID：占用组的 x 位置来表示</li><li>sticky-bit：占用其他人的 x 位置来表示</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">23420</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2010</span><span class="token plain">-08-11  /usr/bin/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwxr-sr-x </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root </span><span class="token function" style="color:#d73a49">tty</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">11084</span><span class="token plain">  03-10 </span><span class="token number" style="color:#36acaa">21</span><span class="token plain">:28 /usr/bin/write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-sr-x </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">315416</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2010</span><span class="token plain">-01-06  /usr/bin/crontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrws--- </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> root admin </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain">   06-18 01:01 /admin/sales</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxrwxrwt </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain">   06-18 01:01 /tmp</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="特殊权限的数值表示方法">特殊权限的数值表示方法<a href="#特殊权限的数值表示方法" class="hash-link" aria-label="Direct link to 特殊权限的数值表示方法" title="Direct link to 特殊权限的数值表示方法">​</a></h3><p>格式：<code>chmod n0n1n2n3 文件或目录名</code></p><p>使用一个单独的数字模式（n0）由不同权限所对应的数字相加得到一个表示特殊权限的八进制数。</p><table><thead><tr><th>权限</th><th>对应数字</th></tr></thead><tbody><tr><td>SUID</td><td>4</td></tr><tr><td>SGID</td><td>2</td></tr><tr><td>Sticky-bit</td><td>1</td></tr><tr><td>-</td><td>0</td></tr></tbody></table><p><img loading="lazy" alt="image-20221019213553573" src="/en/assets/images/image-20221019213553573-e80c86cc33d9e5e12ad7dd0691a7a229.png" width="366" height="244" class="img_ABpA"></p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 为程序 ~/bin/myapp 添加 SUID权限</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> u+s ~/bin/myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4755</span><span class="token plain"> ~/bin/myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 为目录 /home/groupspace 添加 SGID权限</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> g+s /home/groupspace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2755</span><span class="token plain"> /home/groupspace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 为目录 /home/share 添加 sticky-bit 权限</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> o+t /home/share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chmod</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1755</span><span class="token plain"> /home/share</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_J8e2" id="posix-文件访问控制列表">POSIX 文件访问控制列表<a href="#posix-文件访问控制列表" class="hash-link" aria-label="Direct link to POSIX 文件访问控制列表" title="Direct link to POSIX 文件访问控制列表">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="文件访问控制列表简介">文件访问控制列表简介<a href="#文件访问控制列表简介" class="hash-link" aria-label="Direct link to 文件访问控制列表简介" title="Direct link to 文件访问控制列表简介">​</a></h3><p>IEEE POSIX 1003.1e 制定了 ACL 标准。</p><p>FACL 是访问控制列表（File Access Control Lists）的缩写，简称 ACL。ACL 给予用户和管理员更灵活的控制文件读写和权限赋予的能力。</p><ul><li>ACL 是标准 UNIX 文件属性（r, w）的附加扩展。</li><li>ACL 可以针对任意指定的用户/组分配 RWX 权限。</li><li>ACL 允许用户共享文件避免使用冒险的 777 权限。</li></ul><p>支持 FACL 的操作系统：</p><ul><li>主流的商业 UNIX 系统</li><li>FreeBSD、Linux 系统</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="linux-的-facl-支持">Linux 的 FACL 支持<a href="#linux-的-facl-支持" class="hash-link" aria-label="Direct link to Linux 的 FACL 支持" title="Direct link to Linux 的 FACL 支持">​</a></h3><p>ACL 需要内核和文件系统的同时支持。Linux 从 2.6 内核开始提供了对 EXT2/EXT3, JFS, XFS, ReiserFS 等文件系统的 ACL 支持。</p><p>ACL 的文件系统支持：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 通过文件系统的挂装选项实现 ACL 支持</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">mount</span><span class="token plain"> -t ext4 -o acl </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">device name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">partition</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或修改 /etc/fstab 的挂装选项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看ext4文件系统的默认选项</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tune2fs -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">device name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">partition</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Default mount options: user_xattr acl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 在RHEL/Fedora/CentOS中，ACL是默认(defaults)挂装选项</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="acl-类型">ACL 类型<a href="#acl-类型" class="hash-link" aria-label="Direct link to ACL 类型" title="Direct link to ACL 类型">​</a></h3><p>存取 ACL（access ACLs）：是对指定文件或目录的存取控制列表。 默认 ACL（default ACLs）：</p><ul><li>只能和目录相关。</li><li>若目录中的文件没有存取 ACL，就会使用该目录的默认 ACL。但是访问 ACL 的优先级更高。</li><li>默认 ACL 是可选的。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="acl-工具">ACL 工具<a href="#acl-工具" class="hash-link" aria-label="Direct link to ACL 工具" title="Direct link to ACL 工具">​</a></h3><p>在 RHEL/CentOS 中由 acl 软件包提供。</p><ul><li>getfacl：获取文件的 FACL 信息</li></ul><p>格式：<code>getfacl &lt;file|directory&gt;</code></p><ul><li>setfacl：设置文件的 FACL 信息</li></ul><p>自动获得 ACL 权限：</p><ul><li>若目录已设置了默认 ACL，则新创建的文件将从其目录继承默认 ACL 设置。</li><li>使用 mv 命令和 cp -p 命令操作文件时将保持 ACL 设置。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="setfacl-命令">setfacl 命令<a href="#setfacl-命令" class="hash-link" aria-label="Direct link to setfacl 命令" title="Direct link to setfacl 命令">​</a></h3><p>格式：<code>setfacl [-R] {-m|-x} &lt;rules&gt; &lt;files or directory&gt;</code></p><p>说明：</p><ul><li>-<!-- -->R 选项用于对目录进行递归操作</li><li>-<!-- -->m 选项表示修改 ACL 权限</li><li>-<!-- -->x 选项表示删除 ACL 权限</li><li>rules 为要设置的 ACL 规则</li></ul><p>setfacl 命令中的 ACL 规则：</p><ul><li><code>[d:]u:uid:perms</code>：为指定的用户（使用 UID 或用户名）设置 ACL 权限</li><li><code>[d:]g:gid:perms</code>：为指定的组（使用 GID 或组名）设置 ACL 权限</li><li><code>[d:]o:[:]perms</code>：为其他用户设置 ACL 权限</li><li><code>[d:]m:[:]perms</code>：设置有效的访问掩码</li></ul><blockquote><ul><li>当使用 d:前缀时用于设置默认 ACL，当使用 d:前缀时只能对目录设置</li><li>perms 为 r、w、x、-或其组合</li></ul></blockquote><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -m u:gandolf:rwx </span><span class="token function" style="color:#d73a49">file</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -m g:nazgul:rw </span><span class="token function" style="color:#d73a49">file</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -m d:u:frodo:rw directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -x u:samwise </span><span class="token function" style="color:#d73a49">file</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setfacl -R -m g:doc:rwx,d:g:doc:rwx,g:everyone:--- /data/share/</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cworld1/linux-learning/blob/main/docs/main/07-account-and-authority-manage.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OYEL" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_e0Br"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/main/file-sys-manage"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">文件系统管理</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/main/network-config-and-tools"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">网络配置与网络工具</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Clu8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#内容要点" class="table-of-contents__link toc-highlight">内容要点</a><ul><li><a href="#学习目标" class="table-of-contents__link toc-highlight">学习目标</a></li></ul></li><li><a href="#账户管理的相关概念" class="table-of-contents__link toc-highlight">账户管理的相关概念</a><ul><li><a href="#账户实质" class="table-of-contents__link toc-highlight">账户实质</a></li><li><a href="#用户" class="table-of-contents__link toc-highlight">用户</a></li><li><a href="#组" class="table-of-contents__link toc-highlight">组</a></li><li><a href="#用户和组的关系" class="table-of-contents__link toc-highlight">用户和组的关系</a></li><li><a href="#shadow-password" class="table-of-contents__link toc-highlight">Shadow password</a></li><li><a href="#验证账号文件的一致性" class="table-of-contents__link toc-highlight">验证账号文件的一致性</a></li><li><a href="#用户默认环境配置及模板" class="table-of-contents__link toc-highlight">用户默认环境配置及模板</a></li></ul></li><li><a href="#用户和组管理" class="table-of-contents__link toc-highlight">用户和组管理</a><ul><li><a href="#用户管理" class="table-of-contents__link toc-highlight">用户管理</a></li><li><a href="#组管理" class="table-of-contents__link toc-highlight">组管理</a></li><li><a href="#组成员管理" class="table-of-contents__link toc-highlight">组成员管理</a></li></ul></li><li><a href="#批量用户管理" class="table-of-contents__link toc-highlight">批量用户管理</a><ul><li><a href="#批量用户管理工具" class="table-of-contents__link toc-highlight">批量用户管理工具</a></li><li><a href="#newusers-命令" class="table-of-contents__link toc-highlight">newusers 命令</a></li><li><a href="#chpasswd-命令" class="table-of-contents__link toc-highlight">chpasswd 命令</a></li><li><a href="#pwgen-命令" class="table-of-contents__link toc-highlight">pwgen 命令</a></li></ul></li><li><a href="#口令维护和口令时效" class="table-of-contents__link toc-highlight">口令维护和口令时效</a><ul><li><a href="#口令维护" class="table-of-contents__link toc-highlight">口令维护</a></li><li><a href="#口令时效" class="table-of-contents__link toc-highlight">口令时效</a></li><li><a href="#设置新添用户的口令时效" class="table-of-contents__link toc-highlight">设置新添用户的口令时效</a></li><li><a href="#设置已存在用户的口令时效chage-命令" class="table-of-contents__link toc-highlight">设置已存在用户的口令时效（chage 命令）</a></li><li><a href="#用户切换命令" class="table-of-contents__link toc-highlight">用户切换命令</a></li><li><a href="#账户相关命令" class="table-of-contents__link toc-highlight">账户相关命令</a></li><li><a href="#id-命令" class="table-of-contents__link toc-highlight">id 命令</a></li></ul></li><li><a href="#文件和目录的基本权限" class="table-of-contents__link toc-highlight">文件和目录的基本权限</a><ul><li><a href="#权限概述" class="table-of-contents__link toc-highlight">权限概述</a></li><li><a href="#三种基本权限" class="table-of-contents__link toc-highlight">三种基本权限</a></li><li><a href="#分配三种基本权限" class="table-of-contents__link toc-highlight">分配三种基本权限</a></li><li><a href="#查看文件目录的权限" class="table-of-contents__link toc-highlight">查看文件/目录的权限</a></li><li><a href="#文件目录的权限" class="table-of-contents__link toc-highlight">文件/目录的权限</a></li><li><a href="#常见的权限字符串及其含义" class="table-of-contents__link toc-highlight">常见的权限字符串及其含义</a></li><li><a href="#与权限相关的命令" class="table-of-contents__link toc-highlight">与权限相关的命令</a></li><li><a href="#修改文件目录的权限chmod" class="table-of-contents__link toc-highlight">修改文件/目录的权限（chmod）</a></li><li><a href="#改变文件目录属主或组chownchgrp" class="table-of-contents__link toc-highlight">改变文件/目录属主或组（chown、chgrp）</a></li><li><a href="#设置生成文件目录时的默认权限" class="table-of-contents__link toc-highlight">设置生成文件/目录时的默认权限</a></li><li><a href="#umask-命令" class="table-of-contents__link toc-highlight">umask 命令</a></li></ul></li><li><a href="#三种特殊权限" class="table-of-contents__link toc-highlight">三种特殊权限</a><ul><li><a href="#特殊权限的文字表示方法" class="table-of-contents__link toc-highlight">特殊权限的文字表示方法</a></li><li><a href="#特殊权限的数值表示方法" class="table-of-contents__link toc-highlight">特殊权限的数值表示方法</a></li></ul></li><li><a href="#posix-文件访问控制列表" class="table-of-contents__link toc-highlight">POSIX 文件访问控制列表</a><ul><li><a href="#文件访问控制列表简介" class="table-of-contents__link toc-highlight">文件访问控制列表简介</a></li><li><a href="#linux-的-facl-支持" class="table-of-contents__link toc-highlight">Linux 的 FACL 支持</a></li><li><a href="#acl-类型" class="table-of-contents__link toc-highlight">ACL 类型</a></li><li><a href="#acl-工具" class="table-of-contents__link toc-highlight">ACL 工具</a></li><li><a href="#setfacl-命令" class="table-of-contents__link toc-highlight">setfacl 命令</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs">笔记简述</a></li></ul></div><div class="col footer__col"><div class="footer__title">联系</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cworld.top/" target="_blank" rel="noopener noreferrer" class="footer__link-item">个人博客</a></li><li class="footer__item"><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ©2024 CWorld •           <a href="https://docusaurus.io/">Docusaurus 2</a> 强力驱动 •           总访问 <span id="busuanzi_value_site_pv">???</span> 次</div><script src="https://busuanzi.icodeq.com/busuanzi.pure.mini.js"></script></div></div></footer></div>
<script src="/en/assets/js/runtime~main.6c22165c.js"></script>
<script src="/en/assets/js/main.35fdb439.js"></script>
</body>
</html>