<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-main/process-management">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">进程管理 | Linux Learning</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://linux.cworld.top/docs/main/process-management"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="进程管理 | Linux Learning"><meta data-rh="true" name="description" content="关于 Linux 进程管理的讲解。"><meta data-rh="true" property="og:description" content="关于 Linux 进程管理的讲解。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linux.cworld.top/docs/main/process-management"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/process-management" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/en/docs/main/process-management" hreflang="en"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/process-management" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Linux Learning RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Linux Learning Atom Feed"><link rel="stylesheet" href="/assets/css/styles.cbb58a28.css">
<link rel="preload" href="/assets/js/runtime~main.04dd30b5.js" as="script">
<link rel="preload" href="/assets/js/main.9892e731.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="CWorld Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="CWorld Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">CWorld Project</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">笔记</a></div><div class="navbar__items navbar__items--right"><a href="https://blog.cworld.top/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">博客</a><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/main/process-management" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/main/process-management" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">笔记简述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/课程说明">课程说明</a><button aria-label="打开/收起侧边栏菜单「课程说明」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/主要章节">主要章节</a><button aria-label="打开/收起侧边栏菜单「主要章节」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/linux-intro-and-install">Linux 介绍和安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/adv-char-operation">字符界面操作进阶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/disk-part-and-lvm">磁盘分区和 LVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/file-sys-manage">文件系统管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/account-and-authority-manage">账户管理和权限管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/network-config-and-tools">网络配置与网络工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/main/process-management">进程管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/sys-monitor-and-log">系统监视与系统日志</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/附加章节">附加章节</a><button aria-label="打开/收起侧边栏菜单「附加章节」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/主要章节"><span itemprop="name">主要章节</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">进程管理</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>进程管理</h1><p>关于 Linux 进程管理的讲解。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="内容要点">内容要点<a class="hash-link" href="#内容要点" title="标题的直接链接">​</a></h2><ul><li>进程概述</li><li>进程管理</li><li>作业控制</li><li>守护进程（Xinetd 和 TCPWappers）</li><li>安排周期性任务</li></ul><p>本章学习目标：</p><ul><li>理解进程相关概念</li><li>掌握如何运行后台进程及注销后继续执行</li><li>掌握进程管理命令的使用</li><li>掌握作业控制的命令及快捷键的使用</li><li>理解并管理守护进程</li><li>掌握用 Xinetd 和 TCPWappers 配置访问控制的方法</li><li>掌握周期性任务的设置方法</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="进程相关概念">进程相关概念<a class="hash-link" href="#进程相关概念" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="程序进程和作业">程序、进程和作业<a class="hash-link" href="#程序进程和作业" title="标题的直接链接">​</a></h3><ul><li><p>程序（program）：机器指令的集合，文件形式存储</p></li><li><p>进程（process）：一个程序在其自身的虚拟地址空间中的一次 执行活动</p></li><li><p>作业/任务（job/task）：用户通过操作系统用户接口（Shell 或 X 环境）提交给计算机进行加工处理的程序。</p><p>如用户发出一个打印命令，就产生一个打印作业/任务。</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="进程">进程<a class="hash-link" href="#进程" title="标题的直接链接">​</a></h3><ul><li>进程是一个动态实体。</li><li>进程是处理器通过操作系统调度的基本单位。</li><li>每个进程的执行都独立于系统中的其它进程。</li><li>进程之间可以通过称为进程间通信（IPC）的机制进行交互。</li><li>当进程之间共享数据时，操作系统使用了同步技术来保证共享的合法性。</li></ul><p>进程和程序概念的比较：</p><ul><li>程序只是一个<strong>静态的指令集合</strong>；而进程是一个程序的<strong>动态执行过程</strong>，它具有生命期，是动态的产生和消亡的。</li><li>进程是<strong>资源申请、调度和独立运行的单位</strong>，因此，它使用系统中的运行资源；而程序不能申请系统资源、不能被系统调度、也不能作为独立运行的单位，因此，它不占用系统的运行资源。</li><li>程序和进程<strong>没有一一对应的关系</strong>。一方面一个程序可以由多个进程所共用，即一个程序在运行过程中可以产生多个进程；另一方面，一个进程在生命期内可以顺序的执行若干个程序。</li></ul><p>多用户</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="linux-是多用户多任务系统">Linux 是多用户多任务系统<a class="hash-link" href="#linux-是多用户多任务系统" title="标题的直接链接">​</a></h3><p>当多个用户同时在一个系统上工作时，Linux 要能够同时满足用户们的要求，而且还要使用户感觉不到系统在同时为多个用户服务，就好像每一个用户都单独拥有整个系统一样。</p><ul><li>每个用户均可同时运行多个程序。为了区分每一个运行的程序，Linux 给每个进程都做了标识，称为进程号（process ID），每个进程的进程号是<strong>唯一</strong>的。</li><li>Linux 给每个进程都打上了运行者的标志，用户可以控制自己的进程：给自己的进程分配不同的优先级，也可以随时终止自己的进程。</li><li>进程<strong>从执行它的用户处继承 UID、GID</strong>，从而决定对文件系统的存取和访问。</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux-的多任务实现分时技术">Linux 的多任务实现（分时技术）<a class="hash-link" href="#linux-的多任务实现分时技术" title="标题的直接链接">​</a></h4><p>Linux 不可能在一个 CPU 上同时处理多个任务（作业）请求，而是采用 “分时” 技术来处理这些任务请求。</p><p>分时技术是指所有的任务请求被排除一个队列，系统按顺序每次从这个队列中抽取一个任务来执行，这个任务执行很短的时间（几毫秒）后，系统就将它排到任务队列的末尾，然后读入队列中的下一个任务，以同样的方式执行。这样经过一段时间后，任务队列中的所有任务都被执行一次，然后又开始下一轮循环。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="linux-中的进程识别">Linux 中的进程识别<a class="hash-link" href="#linux-中的进程识别" title="标题的直接链接">​</a></h4><p>使用 PID 区分不同的进程：</p><ul><li>系统启动后的第一个进程是 init，它的 PID 是 1。</li><li>init 是唯一一个由系统内核直接运行的进程。</li><li>除了 init 之外，每个进程都有父进程（PPID 标识）。</li></ul><p>此外每个进程还有四个与用户和组相关的识别号：</p><ul><li>实际用户识别号（real user ID，简称 RUID）</li><li>实际组识别号（real group ID，简称 RGID）</li><li>有效用户识别号（effect user ID，简称 EUID）</li><li>有效组识别号（effect group ID，简称 EGID）</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="用户进程与权限">用户、进程与权限<a class="hash-link" href="#用户进程与权限" title="标题的直接链接">​</a></h4><p>RUID 和 RGID 的作用：识别正在运行此进程的用户和组。</p><ul><li>一个进程的 RUID 和 RGID 就是运行此进程的 UID 和 GID。</li></ul><p>EUID 和 EGID 的作用：确定一个进程对其访问的文件的权限。</p><ul><li>除了产生进程的程序被设置 SUID 和 SGID 权限位之外，一般 EUID、EGID 分别和 RUID、RGID 相同。</li><li>若程序被设置了 SUID 或 SGID 权限位，则此进程相应的 EUID 和 EGID，将和运行此进程的文件的所属用户的 UID 或所属组的 GID 相同。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="进程的启动方式">进程的启动方式<a class="hash-link" href="#进程的启动方式" title="标题的直接链接">​</a></h3><ol><li>手工方式：使用操作系统提供的用户接口，包括前台和后台（&amp;）</li><li>调度方式：按照预先指定的时间执行，包括 cron、at 和 batch</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="前台与后台">前台与后台<a class="hash-link" href="#前台与后台" title="标题的直接链接">​</a></h3><p>前台进程：指一个程序控制着标准输入/输出，在程序运行时，shell 被暂时挂起，直到该程序运行结束后，才退回到 shell。在这个过程中，用户不能再执行其它程序。</p><p>后台进程：用户不必等待程序运行结束就可以执行其它程序。</p><p>运行后台进程的方法是在命令行最后加上 “&amp;”，例如：<code>$ sleep 10000 &amp;</code></p><blockquote><p>在一个终端里只能同时存在一个前台任务，但可以有多个后台任务。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="管理进程">管理进程<a class="hash-link" href="#管理进程" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看系统种的进程ps">查看系统种的进程（ps）<a class="hash-link" href="#查看系统种的进程ps" title="标题的直接链接">​</a></h3><p>使用 ps（Process Status）命令查看进程状态信息：</p><ul><li>显示哪些进程正在执行和执行的状态</li><li>进程是否结束、进程有没有僵死</li><li>哪些进程占用了过多的系统资源等</li></ul><p>格式：<code>ps [选项]</code></p><blockquote><p>不带任何选项的 ps 命令：显示当前用户所在终端中的所有进程。</p><p>输出项包括：识别号(PID)、终端(TTY)、运行时间(TIME)、产生该进程所运行的命令(CMD)</p></blockquote><p>选项：</p><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td><code>-e</code></td><td>显示所有进程，等价于 -A。</td></tr><tr><td><code>-f</code></td><td>完全（FULL）显示。增加显示用户名、PPID、进程起始时间。</td></tr><tr><td><code>f</code>/<code>-H</code></td><td>显示进程树，等价于 --forest。</td></tr><tr><td><code>a</code></td><td>显示终端上的所有进程，包括其他用户地进程。</td></tr><tr><td><code>x</code></td><td>显示没有控制终端地进程。</td></tr><tr><td><code>u</code></td><td>面向用户的显示格式。增加显示用户名，进程起始时间，CPU 和内存占用百分比等信息。</td></tr><tr><td><code>-u &lt;username&gt;</code></td><td>仅显示指定用户的进程。</td></tr><tr><td><code>l</code>/<code>-l</code></td><td>长格式显示。增加显示进程的 UID、PPID 和优先权值。</td></tr><tr><td><code>w[w]</code>/<code>-w[w]</code></td><td>加宽显示。通常用于显示完整的命令行。</td></tr><tr><td><code>o</code>/<code>-o &lt;format&gt;</code></td><td>由用户自定义输出列。</td></tr><tr><td><code>--sort &lt;order&gt;</code></td><td>指定按哪/哪些列排序，order 格式为：<code>[+/-] key [,[+/-] key [,...]]</code></td></tr></tbody></table><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -ef</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -eH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -elw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> au</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> axf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> auxw</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ps 常见的输出标记：</p><blockquote><p>ps 的输出依赖于用户所给的选项。</p></blockquote><table><thead><tr><th>选项</th><th>说明</th><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>UID</td><td>用户 ID</td><td>START</td><td>进程启动时间</td></tr><tr><td>USER</td><td>用户名</td><td>TIME</td><td>执行时间</td></tr><tr><td>PID</td><td>进程 ID</td><td>STAT</td><td>进程状态</td></tr><tr><td>PPID</td><td>父进程的 ID</td><td>NI</td><td>优先权值 / nice 值</td></tr><tr><td>TTY</td><td>启动进程的终端</td><td>CMD</td><td>命令名（COMMAND）</td></tr><tr><td>RSS</td><td>进程所用内存块数</td><td>%CPU</td><td>进程所用 CPU 时间百分比（pcpu）</td></tr><tr><td>VSZ</td><td>进程所用虚拟内存块数</td><td>%MEM</td><td>进程所有 MEM 百分比（pmem）</td></tr></tbody></table><p>ps 命令的进程状态列（指 &quot;STAT&quot; 或 &quot;S&quot; 列的输出）：</p><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>R</td><td>正在运行或处在运行队列中</td></tr><tr><td>S</td><td>休眠</td></tr><tr><td>T</td><td>停止或被追踪</td></tr><tr><td>W</td><td>进程在 RAM 中没有驻留页（2.6.xx 的内核无效）</td></tr><tr><td>D</td><td>不可中断的睡眠，通常指 I/O</td></tr><tr><td>Z</td><td>僵尸进程（已结束但未被父进程收回）</td></tr><tr><td>X</td><td>已死进程（这个状态不会出现）</td></tr><tr><td>&lt;</td><td>具有最高优先权</td></tr><tr><td>N</td><td>具有较低的优先权</td></tr></tbody></table><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 指定输出列</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> o user,pid,ppid,pcpu,pmem,nice,cmd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -eo pid,tid,class,rtprio,ni,pri,psr,pcpu,stat,wchan:14,comm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> axo stat,euid,ruid,tty,tpgid,sess,pgrp,ppid,pid,pcpu,comm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -eo “%p %y %x %n %c” </span><span class="token comment" style="color:#999988;font-style:italic"># AIX风格</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 对指定列排序</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -ef --sort user,-time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux --sort -pcpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux --sort -pmem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> o user,pid,ppid,pcpu,pmem,nice,cmd --sort </span><span class="token function" style="color:#d73a49">nice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="搜索进程">搜索进程<a class="hash-link" href="#搜索进程" title="标题的直接链接">​</a></h3><p>使用 <code>ps</code> 和 <code>| grep</code>：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> aux </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查找符合条件的进程PID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pgrep httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pidof httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -C httpd -o </span><span class="token assign-left variable" style="color:#36acaa">pid</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pgrep -U apache httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pgrep -G student -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="进程调度的优先权">进程调度的优先权<a class="hash-link" href="#进程调度的优先权" title="标题的直接链接">​</a></h3><ul><li>进程的优先权决定对 CPU 的使用</li><li>进程在运行时可以享有不同等的优先权</li><li>进程的优先权受进程的 nice 值的影响（nice 值的范围为 -20<!-- -->~<!-- -->19，默认是 0），值越小说明对 CPU 的使用越优先</li></ul><p>查看进程优先级（看 NI 列的值）：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -o comm,nice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="改变进程调度优先权">改变进程调度优先权<a class="hash-link" href="#改变进程调度优先权" title="标题的直接链接">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="在启动进程时指定nice">在启动进程时指定（nice）<a class="hash-link" href="#在启动进程时指定nice" title="标题的直接链接">​</a></h4><p>nice 命令用于启动进程时指定优先级。</p><p>格式：<code>nice –&lt;优先级改变量&gt; 命令 [&amp;]</code></p><p>其中优先级改变量是指优先级的增量：</p><ul><li>若为正，表示增加 nice 值，即降低进程优先权</li><li>若为负，表示减小 nice 值，即提高优先权</li><li>若缺省，则默认为 10，即 nice 值 增加 10</li></ul><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">nice</span><span class="token plain"> –5 lp paper.pdf </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 如超级用户（root）忙着打印一份演讲稿</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">nice</span><span class="token plain"> –-10 lp report.pdf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>注：</p><ul><li>使用 nice 同样可以改变前台任务的优先级；</li><li>只有 root 才有权限提高一个进程的优先权。</li></ul></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="在进程运行过程中调整renice">在进程运行过程中调整（renice）<a class="hash-link" href="#在进程运行过程中调整renice" title="标题的直接链接">​</a></h4><p>renice 命令用于在进程运行后调整优先级。</p><ul><li>在系统资源紧张时，可以通过降低其它不着急的进程的优先权，从而使得急用的进程能分得更多的 CPU 时间。</li><li>root 可以提高进程的优先权，但普通用户没这个权限。</li></ul><p>格式：<code>renice &lt;优先级&gt; [-p pid] [-u user] [-g gid]</code></p><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">renice</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> –p </span><span class="token number" style="color:#36acaa">2345</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># -p 可以省略</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>注：</p><ul><li>普通用户调整 NI 值的范围是 0<!-- -->~<!-- -->19，而且只能调整自己的进程。</li><li>普通用户只能调高 NI 值，而不能降低。如原本 NI 值为 0，则只能调整为大于 0。</li><li>普通用户一旦降低某个进程的优先级 (即增加优先值) 后，就无法再回复到原来的优先级。</li></ul></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="进程信号signal">进程信号（signal）<a class="hash-link" href="#进程信号signal" title="标题的直接链接">​</a></h3><p>进程信号是在软件层次上对中断机制的一种模拟，在原理上，一个进程收到一个信号与处理器收到一个中断请求可以说是一样的。</p><p>进程信号是最基本的进程间通讯方式：</p><ul><li>可以在进程之间直接发送，而不需要用户界面</li><li>可以在 Shell 中通过 kill 命令发送给进程</li></ul><p>Linux 对每种进程信号都规定了默认关联动作。</p><p>查看可用的进程信号：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">kill</span><span class="token plain">  -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">man</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> signal</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="进程信号和信号发送">进程信号和信号发送<a class="hash-link" href="#进程信号和信号发送" title="标题的直接链接">​</a></h3><p>常见的进程信号：</p><ul><li>SIGTERM | TERM（15）：正常终止 (默认)</li><li>SIGKILL | KILL（9）：立即终止</li><li>SIGHUP | HUP（1）：重读配置文件</li><li>STOP（17）：暂停</li></ul><p>给进程发送信号：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 按PID：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">kill</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">信号</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> PID …</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 按名称：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">killall</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">信号</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> COMM …</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 按模式：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">pkill</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-信号</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> 模式</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>其中信号可以使用名称或数字号码。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="杀死进程">杀死进程<a class="hash-link" href="#杀死进程" title="标题的直接链接">​</a></h3><p>杀死进程的原因：</p><ul><li>该进程占用了过多的 CPU 时间</li><li>该进程锁住了一个终端，使其他前台进程无法运行</li><li>运行时间过长，但没有预期效果或无法正常退出</li><li>产生了过多的屏幕或磁盘文件的输出</li></ul><p>可以使用 kill/killall 命令来杀死进程。</p><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">kill</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 也可写作：$ kill -9 1234</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">killall</span><span class="token plain">  myprog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 也可写作：$ killall -9 myprog</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>注：</p><ul><li>使用 kill 前需要先用 ps 查看需要终止的进程的 pid；</li><li><code>kill –9</code> 很霸道，它在杀死一个进程的同时，将杀死其所有子进程，使用时要谨慎。如错杀 login 进程或 shell 进程等。</li></ul></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="作业控制">作业控制<a class="hash-link" href="#作业控制" title="标题的直接链接">​</a></h3><p>作业控制是指控制当前正在运行的进程的行为，也被称为进程控制。</p><p>暂时停止某个运行程序：使用 Ctrl + Z 或发送信号 17（STOP）</p><p>管理后台作业或暂停的作业：</p><ul><li>列举作业号码和名称：<code>jobs</code></li><li>在后台恢复运行：<code>bg [%作业号码]</code></li><li>在前台恢复运行：<code>fg [%作业号码]</code></li><li>发送信号：<code>kill -[信号] [％作业号码]</code></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="守护进程">守护进程<a class="hash-link" href="#守护进程" title="标题的直接链接">​</a></h2><p>始终在后台运行并响应合法请求的程序称为守护（Daemon）进程。</p><ul><li>守护进程不是由用户启动运行的，也不与终端关联。</li><li>一个实际运行中的系统一般会有多个守护进程在运行，且各个系统中运行的守护进程都不尽相同。</li><li>除非程序异常中止或者人为终止，否则它们将一直运行下去直至系统关闭。</li></ul><blockquote><p>UNIX/Linux 的守护进程在 Windows 系统中被称作“服务”。</p></blockquote><p>查看系统当前运行的守护进程：pstree</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="守护进程的分类">守护进程的分类<a class="hash-link" href="#守护进程的分类" title="标题的直接链接">​</a></h3><p>系统守护进程:</p><ul><li>计划性任务 daemon，如 atd、crond</li><li>系统日志 daemon，如 syslogd</li><li>打印假脱机 daemon，如 cupsd、lpd</li><li>网络参数设置 daemon，如 network</li></ul><p>网络守护进程：</p><ul><li>各种网络协议侦听 daemon，如：sshd、httpd、sendmail、vsftpd</li><li>网络超级服务器（Supper Server），如：xinetd 或 inetd</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="客户机服务器模型">客户机/服务器模型<a class="hash-link" href="#客户机服务器模型" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20221115201020102" src="/assets/images/image-20221115201020102-08a3241247d01653a33cc7d31387f122.png" width="890" height="838" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="网络守护进程的工作原理">网络守护进程的工作原理<a class="hash-link" href="#网络守护进程的工作原理" title="标题的直接链接">​</a></h3><p>网络程序之间的连接是通过端口之间的连接而实现的。在 C/S 模型中，服务器监听（Listen）在一个特定的端口上等待客户的连接。连接成功之后客户机与服务器通过端口进行数据通讯。</p><p>守护进程的工作就是打开一个端口，并且等待并监听（Listen）进入的连接。如果客户提请了一个连接，守护进程就创建（fork）子进程来响应此连接，而父进程继续监听更多的服务请求。因此，每个守护进程都可以处理多个客户服务请求。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="超级服务器的引入">超级服务器的引入<a class="hash-link" href="#超级服务器的引入" title="标题的直接链接">​</a></h3><p>对于系统所要提供的每一种网络服务，都必须运行一个监听某个端口连接发生的守护程序，这通常意味着系统资源的浪费。</p><p>为了避免系统资源浪费引入了“超级服务器”：</p><ol><li>超级服务器启动后同时监听它所管理的服务的所有端口</li><li>当有客户提出服务请求时：<ul><li>超级服务器会判断这是对哪一个服务的请求，然后再开启与此服务相应的守护进程</li><li>由超级服务器产生的某服务的进程处理客户的请求，当处理结束便终止此服务进程</li><li>超级服务器本身继续监听其他服务请求</li></ul></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="守护进程的启动方式">守护进程的启动方式<a class="hash-link" href="#守护进程的启动方式" title="标题的直接链接">​</a></h3><p>独立启动：</p><ul><li>独立运行的守护进程由 init 脚本负责管理</li><li>独立运行的守护进程的脚本存放在 /etc/rc.d/init.d/ 目录下</li><li>所有的系统服务都是独立运行的。如：crond、syslogd 等</li><li>一些常用的网络守护进程是独立运行的。如：httpd 等</li></ul><p>瞬态启动：</p><ul><li>由网络超级服务器（xinetd）运行的守护进程</li><li>由 xinetd 管理的守护进程的配置文件存在 /etc/xinetd.d/ 目录下</li><li>默认的 xinetd 的主配置文件是 /etc/xinetd.conf</li><li>一些不常用的网络守护进程是由 xinetd 启动的，如：telnet、tftp 等</li><li><strong>xinetd 本身是独立运行的守护进程</strong></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="守护进程管理工具">守护进程管理工具<a class="hash-link" href="#守护进程管理工具" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="用-chkconfig-管理守护进程">用 chkconfig 管理守护进程<a class="hash-link" href="#用-chkconfig-管理守护进程" title="标题的直接链接">​</a></h3><p>chkconfig 的功能：</p><ul><li>添加指定的新服务</li><li>清除指定的服务</li><li>显示由 chkconfig 管理的服务</li><li>改变服务的运行级别</li><li>检查服务的启动状态</li></ul><p>chkconfig 命令的格式</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --list </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">server-name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --add server-name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --del server-name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--level levels</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> server-name </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">off</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">reset</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看指定的服务在所有运行级别的运行状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --list </span><span class="token function" style="color:#d73a49">sendmail</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 显示由 chkconfig 管理的所有服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 添加一个由chkconfig管理的服务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --add httpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 更改指定服务在指定运行级别的运行状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> --level </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> httpd on</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 chkconfig 增加一个服务：</p><ol><li>服务脚本必须存放在 /etc/init.d/ 目录下</li><li>使用命令 <code>chkconfig --add servicename</code> 来创建 在 chkconfig 工具服务列表中增加此服务，此时服务会被在 <code>/etc/rc.d/rcN.d</code> 中赋予 K/S 入口</li><li>使用命令 <code>chkconfig --level 35 mysqld on</code> 修改服务的默认启动等级</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="管理守护进程">管理守护进程<a class="hash-link" href="#管理守护进程" title="标题的直接链接">​</a></h3><p>service/systemctl 的功能：在系统运行期间改变守护程序的运行状态</p><p>命令格式：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># service server-name status</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">server-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> start</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">stop</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># systemctl status server-name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl is-active </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">server-name</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">stop</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">restart </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">server-name</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看系统中的所有守护进程的状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> --status-all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看某个具体的守护进程的状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> vsftpd status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 启动或停止某个守护进程</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 独立运行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> httpd start</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">stop</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">restart</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 由xinetd运行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">chkconfig</span><span class="token plain"> tftp on</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> xinetd restart</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="超级服务器">超级服务器<a class="hash-link" href="#超级服务器" title="标题的直接链接">​</a></h3><p>xinetd 是新一代的网络守护进程服务程序，提供类似于早期的 inetd + tcp_wrapper 的功能，但与之相比 xinetd 更加强大和安全。</p><p>xinetd 的功能：</p><ul><li>支持 tcp、ucp、RPC 协议服务</li><li>基于时间段的访问控制</li><li>功能完备的 log 功能，能限制 log 文件大小</li><li>能有效的防止 DoS 攻击（Denial of Services）</li><li>能限制同时运行的同一类型的服务器数目</li><li>能限制启动的所有服务器的数目</li><li>整合了 TCP Wrappers 的 libwrap.so 库</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="xinetd-的配置">xinetd 的配置<a class="hash-link" href="#xinetd-的配置" title="标题的直接链接">​</a></h4><p>xinetd 的配置文件：</p><ul><li>/etc/xinetd.conf</li><li>/etc/xinetd.d/<!-- -->*</li></ul><p>xinetd 的常见配置参数：</p><ul><li>disable {no|yes} 定义是否启动 （no 表示开启，yes 表示关闭）</li><li>socket_type {stream|dgram} 表示套接字格式 （stream 为 TCP，dgram 为 UDP）</li><li>protocol 协议类型 （这些是需是 /etc/protocol 里可用的）</li><li>wait {yes|no} 允许并发数 （yes 单线程，no 多线程）</li><li>user 运行身份</li><li>server 有哪个文件/程序启用该服务</li><li>server_args 传递的参数</li><li>only-from 白名单</li><li>no-access 黑名单</li><li>access-time 定义访问时间</li><li>log-type {SYSLOG|FILE} 定义输出日志 （SYSLOG 定义日志类型，级别；FILE 定义日志存放位置）</li><li>bind 监听 IP</li><li>log-on-success 记录登陆成功的信息</li><li>log-on-failure 记录登陆失败的信息</li><li>per-source 资源限制，限制某一 ip 同时连接请求数</li><li>phier-source = UNLIMITED 定义来源限制 表示不做限制</li><li>cps = n m 定义每秒最大连接数 定义每秒最大连接数为 n，超出后等待 m 秒后再尝试连接</li></ul><p>如：</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">service tftp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  disable      =  no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  socket_type  =  dgram</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  protocol     =  udp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  wait         =  yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  user         =  root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server       =  /usr/sbin/in.tftpd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  server_args  =  -s /tftpboot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cps          =  </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  flags        =  IPv4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  instances    =  </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  per_source   =  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  access_times =  </span><span class="token number" style="color:#36acaa">7</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">00</span><span class="token number" style="color:#36acaa">-12</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">30</span><span class="token number" style="color:#36acaa">-19</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">00</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  only_from    =  </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.</span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain">/</span><span class="token number" style="color:#36acaa">24</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-wrappers">TCP Wrappers<a class="hash-link" href="#tcp-wrappers" title="标题的直接链接">​</a></h2><p>TCP Wrappers 即 Transmission Control Protocol Wrappers，是一种应用层的网络访问控制程序，原本是个人开发的免费软件，但随着广泛的应用逐渐成为一种标准的安全工具，并在 RHEL/CentOS 中是默认安装的。当然我们也可以手动安装：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum -y </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> tcp_wrappers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>TCP Wrappers 使用访问控制列表（ACL）实现主机访问控制：</p><ul><li>/etc/hosts.allow 是一个许可表</li><li>/etc/hosts.deny 是一个拒绝表</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-wrappers-实现访问控制">TCP Wrappers 实现访问控制<a class="hash-link" href="#tcp-wrappers-实现访问控制" title="标题的直接链接">​</a></h3><p><img loading="lazy" alt="image-20221118200046571" src="/assets/images/image-20221118200046571-85e8f7938aabe540bf26cb04225db63a.png" width="543" height="732" class="img_ev3q"></p><ul><li>读取 /etc/hosts.allow 文件，如果明确允许访问，则提供访问且不再检查 /etc/hosts.deny</li><li>读取 /etc/hosts.deny 文件，如果明确拒绝访问，则指定计算机将被拒绝访问。</li><li>如果两个文件中都没有访问者的计算机名称或 IP 地址，则自动提供访问权。</li><li>如果不存在这两个文件或文件内容为空，则 TCP_Wrappers 的访问控制功能被禁用。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-wrappers-保护机制的实现方式">TCP Wrappers 保护机制的实现方式<a class="hash-link" href="#tcp-wrappers-保护机制的实现方式" title="标题的直接链接">​</a></h3><ol><li><p>由网络服务程序调用 <code>libwrap.so._</code> 链接库（内置 <code>libwrap.so._</code> 库支持的网络服务程序都能使用 TCP Wrappers 来实现访问控制）</p></li><li><p>检查 TCP Wrappers 的支持</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 显示所有支持 TCP Wrappers  的软件包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">rpm</span><span class="token plain"> -q --whatrequires libwrap.so.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看某网络服务程序对 TCP Wrappers 的支持</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldd </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">which</span><span class="token variable" style="color:#36acaa"> sshd</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> libwrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或者：</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings -f /usr/sbin/sshd </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> hosts_access</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><blockquote><p>RHEL/CentOS 中支持 TCP Wrappers 的服务程序：</p><p><code>rpm -q --whatrequires libwrap.so.0</code></p><ul><li>sendmail-8.13.8-8.el5</li><li>quota-3.13-1.2.5.el5</li><li>xinetd-2.3.14-10.el5</li><li>tftp-server-0.49-2.el5.centos</li><li>openssh-server-4.3p2-41.el5_5.1</li><li>vsftpd-2.0.5-16.el5_5.1</li><li>nfs-utils-1.0.9-47.el5_5</li><li>………</li></ul><p>意义：实现对多个服务程序实现集中式管理（Centralized Management）</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-wrappers-与防火墙">TCP Wrappers 与防火墙<a class="hash-link" href="#tcp-wrappers-与防火墙" title="标题的直接链接">​</a></h3><p>通常做法是在 Linux 操作系统上安装 Netfilter/iptables 防火墙来处理网络连接。</p><p>虽然防火墙有非常广泛的用途，但他却不是万能的。例如它无法处理类似的向连接发起者发送一些文本这样的任务。TCP Wrappers 能够完成它以及更多的其他事情，甚至还能提供的一些额外的安全功能。</p><p>但 TCP Wrappers 不应被视为好的防火墙的替代品。TCP Wrappers 应结合防火墙或其他安全加强设施一并使用，为系统多提供一层安全防护。</p><p>下面是 TCP Wrappers 与防火墙图示：</p><p><img loading="lazy" alt="image-20221118202116908" src="/assets/images/image-20221118202116908-6bb7e9dcd999747638e41d2f13e9c272.png" width="529" height="794" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-wrappers-的配置文件语法">TCP Wrappers 的配置文件语法<a class="hash-link" href="#tcp-wrappers-的配置文件语法" title="标题的直接链接">​</a></h3><p>/etc/hosts.allow 和 /etc/hosts.deny 语法：</p><p><code>daemon:hosts:options</code></p><p>其中：</p><ul><li>deamon：可填 ALL 或指定守护程序名称</li><li>hosts：<ul><li>填 ALL</li><li>填 hostname(s)</li><li>填 net. 地址，如 <code>192.168.</code> 表示匹配 192.168.x.x 的地址</li><li>填 net/netmask，如 172.0.0.0/255.0.0.0 表示匹配 172.x.x.x 的地址</li></ul></li><li>options：<ul><li>allow / deny</li><li>spawn/twist shell command</li><li>其他选项也可填写</li></ul></li></ul><blockquote><p>以 <code>#</code> 开始的行为注释；<code>\</code> 为续行符</p><p>任何修改都立即生效，不需要重新启动服务</p></blockquote><p>其中主机名填写：</p><ul><li>LOCAL：本地主机</li><li>KNOWN：可解析域名的主机</li><li>UNKNOWN：不可解析域名的主机</li><li>PARANOID：IP 与其主机名不符的客户</li><li>IP 地址</li><li>域名或主机名，如 <code>.abc.com</code>, <code>www.abc.com</code></li><li>IP 地址段：如 <code>192.168.0.</code> ，<code>12.23.</code></li><li>使用 CIDR（无类型域间选路），如 192.168.0.0/22</li><li>使用 client@host，如 <a href="mailto:osmond@www.abc.com" target="_blank" rel="noopener noreferrer">osmond@www.abc.com</a></li></ul><p>主机和服务宏定义可填写：</p><ul><li>ALL</li><li>EXCEPT（可嵌套）</li></ul><p>主机列表可填写：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sshd: centos.example.com,192.168.0.254</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: .example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: .cracker.org EXCEPT trusted.cracker.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: </span><span class="token number" style="color:#36acaa">123.113</span><span class="token plain">.103.,123.113.13.207,LOCAL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: </span><span class="token number" style="color:#36acaa">123.113</span><span class="token plain">.103. EXCEPT </span><span class="token number" style="color:#36acaa">123.113</span><span class="token plain">.103.207</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.0.0/255.255.254.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.0.0/23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: ALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: ALL EXCEPT </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: ALL EXCEPT </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.1.,PARANOID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshd: /etc/acl/mylists.hosts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如要求仅允许本地主机、192.168.0.x 网段、mynet.com 域访问系统中的 telnet 和独立启动的 vsftpd 服务：</p><ul><li>编辑 /etc/hosts.deny 拒绝所有主机访问：<code>in.telnetd,vsftpd: ALL</code></li><li>编辑 /etc/hosts.allow 开放允许访问的主机：<code>in.telnetd,vsftpd: LOCAL, 192.168.0., .mynet.com</code></li></ul><p>或者使用拓展语法，在 /etc/hosts.allow 中添加如下两条访问控制规则：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">in.telnetd,vsftpd: LOCAL, </span><span class="token number" style="color:#36acaa">192.168</span><span class="token plain">.0., .mynet.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in.telnetd,vsftpd: ALL: deny</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意 allow 或 deny 扩展必须作为一条规则的最后一个选项出现。</p><blockquote><p>注：</p><ul><li>尽量使用 IP 地址，而不用主机名或域名</li><li>使用 allow 或 deny 扩展作为规则的最后一个选项，可以将所有访问规则集中设置在一个配置文件中</li><li><code>&lt;daemon list&gt;</code> 为 process name，而非 service name。如 in.telnetd 非 telnet。</li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="安排自动化任务">安排自动化任务<a class="hash-link" href="#安排自动化任务" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="crond-守护进程">crond 守护进程<a class="hash-link" href="#crond-守护进程" title="标题的直接链接">​</a></h3><p>crond 守护进程负责监控周期性任务的执行。</p><p>crond 守护进程的执行参数参考 /etc/sysconfig/crond。</p><p>控制普通用户的使用：</p><ul><li>若 /etc/cron.allow 存在，仅列在其中的用户允许使用。</li><li>若 /etc/cron.allow 不存在，检查/etc/cron.deny，没有列于其中的所有用户允许使用。</li><li>若两个文件均不存在，仅允许 root 用户使用。</li><li>空的 /etc/cron.deny 文件，表示允许所有用户使用。（默认值）</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="crond-的运行机制">crond 的运行机制<a class="hash-link" href="#crond-的运行机制" title="标题的直接链接">​</a></h4><ul><li>搜索 crontab 文件并载入内存（crontab 文件即 /var/spool/cron/ 目录下以用户名命名的文件以及 /etc/crontab 文件）</li><li>crond 守护进程启动后，检查是否有用户设置了 crontab 文件，如果没有就转入休眠状态，释放系统资源</li><li>crond 守护进程每分钟检查一次 crontab 文件，检验当前是否有需要执行的命令。命令执行结束后，没有被重定向的输出，都将<strong>作为邮件发送</strong>给安排次任务的所有者</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="crond-命令">crond 命令<a class="hash-link" href="#crond-命令" title="标题的直接链接">​</a></h3><p>作用：用于生成 cron 进程所需要的 crontab 文件</p><p>命令格式：</p><ul><li><code>crontab [-u user] &lt;file&gt;</code></li><li><code>crontab [-u user] {-l/-r/-e}</code></li></ul><p>命令参数：</p><ul><li>-<!-- -->l：在标准输出上显示当前的 crontab</li><li>-<!-- -->r：删除当前的 crontab</li><li>-<!-- -->e：使用编辑器编辑当前的 crontab 文件。当结束编辑离开时，编辑后的文件将自动安装。</li></ul><blockquote><p>任何被允许的用户都可以使用 crontab 安排任务。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="crontab-文件的格式">crontab 文件的格式<a class="hash-link" href="#crontab-文件的格式" title="标题的直接链接">​</a></h3><p>详情参见 <code>man 5 crontab</code>。</p><p>每一行由 5 个时间字段及命令组成：</p><p><code>minute hour day-of-month month-of-year day-of-week [username] commands</code></p><p>其中：</p><ul><li>五个时间字段：<ul><li>minute：一小时中的哪一分钟 <!-- -->[<!-- -->0 ～ 59]</li><li>hour：一天中的哪个小时 <!-- -->[<!-- -->0 ～ 23]</li><li>day-of-month：一月中的哪一天 <!-- -->[<!-- -->1 ～ 31]</li><li>month-of-year：一年中的哪一月 <!-- -->[<!-- -->1 ～ 12]</li><li>day-of-week：一周中的哪一天 <!-- -->[<!-- -->0 ～ 6]</li></ul></li><li>两个执行字段：<ul><li>username: 以指定的用户身份执行 commands。省略此字段表示以安排该任务的用户身份执行 commands。</li><li>commands: 要执行的命令，可以是多行命令或者是脚本调用。</li></ul></li></ul><p>注意：</p><ul><li>除了 username 项，所有项都必须填入。</li><li>如果用户不需要指定其中的几项时间，那么可以使用统配符 <!-- -->*<!-- --> 表示任何时间。</li><li>每个时间字段都可以指定多个值，它们之间用 <code>,</code> 间隔，如：<code>1,3,5</code>。</li><li>每个时间字段都可以指定范围，它们之间用 <code>-</code> 间隔 ，如：<code>12-20</code>。</li><li>每个时间字段都可以使用 <code>*/n</code> 表示每隔 n，如：<code>*/2</code>。</li><li>命令应该给出绝对路径，或设置 PATH 环境变量。</li><li>用户必须具有运行所对应的命令或程序的权限。</li><li>注释行以 # 开头。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cron-的使用">cron 的使用<a class="hash-link" href="#cron-的使用" title="标题的直接链接">​</a></h3><ul><li><p>直接使用命令 <code>crontab –e</code> 加载任务：</p><p>在编辑器中输入：<code>00 03 * * 2,4,6 shutdown -r +10</code>；存盘退出。</p></li><li><p>也可以先创建 crontab 文件，然后加载任务：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> “00 03 * * </span><span class="token number" style="color:#36acaa">2,4</span><span class="token plain">,6 </span><span class="token function" style="color:#d73a49">shutdown</span><span class="token plain"> -r +10” </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /root/reboot.cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> /root/reboot.cron</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><p>cron 任务加载以后，可以到 /var/spool/cron 目录进行确认。</p><p>cron 使用范例：</p><ol><li><p>每月 1 日和 15 日凌晨 1:30 使系统进行维护状态，重新启动系统：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">30 01 1,15 * * shutdown -r +10 &gt; /dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每天凌晨的 2 点删除 /ftp/incoming/temp 目录下的所有文件：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">00 02 * * * rm-rf /ftp/incoming/temp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每天凌晨 1 点删除 /tmp 目录下的 7 天没有修改过的所有子目录，但不包括 tmp 目录本身和 lost+found 目录：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">00 01 * * * find /tmp !-name.! -name lost+found \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -type d -mtime +7 -exec /bin/rm-rf {} &#x27;;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每天早上 8 点将 /var/log/secure 文件内容发送给 <a href="mailto:aa@163.com" target="_blank" rel="noopener noreferrer">aa@163.com</a>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0 8 * * * mail aa@163.com &lt; /var/log/secure</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每隔两个小时将命令 <code>netstat -a</code> 的输出发送给 <a href="mailto:aa@163.com" target="_blank" rel="noopener noreferrer">aa@163.com</a>：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0 */2 * * * netstat -a | mail aa@163.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每天 7<!-- -->~<!-- -->19 点开放 samba 服务：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0 7 * * * service smb start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0 19 * * * service smb stop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>每星期日晚上 2 点查看 /home 目录下使用量最大的前十名用户：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0 2 * * 0 root du -sh /home/* | sort -nr | head -10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="系统的-cron-任务">系统的 cron 任务<a class="hash-link" href="#系统的-cron-任务" title="标题的直接链接">​</a></h3><p>crond 守护进程还将搜索系统的 cron 任务配置文件 /etc/crontab。使用 /etc/crontab 文件为系统管理员安排 cron 任务提供了方便。</p><p>以下目录中存放了 /etc/crontab 文件运行时执行的文件：</p><ul><li><code>/etc/cron.hourly/</code>：存放每小时要执行的任务文件</li><li><code>/etc/cron.daily/</code>：存放每天要执行的任务文件</li><li><code>/etc/cron.weekly/</code>：存放每周要执行的任务文件</li><li><code>/etc/cron.monthly/</code>：存放每月要执行的任务文件</li></ul><p>管理员在 /etc/cron.<!-- -->*<!-- -->ly 目录下建立脚本文件来安排 cron 任务，且在脚本中只需写要安排执行的命令即可。</p><p>此外 /etc/cron.d/ 目录包含额外的系统 crontab 文件。</p><p>/etc/crontab 文件：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/crontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SHELL=/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># PATH=/sbin:/bin:/usr/sbin:/usr/bin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># MAILTO=root</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># HOME=/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># # run-parts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 01 * * * * root run-parts /etc/cron.hourly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 02 4 * * * root run-parts /etc/cron.daily</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 22 4 * * 0 root run-parts /etc/cron.weekly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 42 4 1 * * root run-parts /etc/cron.monthly</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>run-parts 是 crontab 软件包的一个命令组件，它用于执行指定目录下的所有可执行文件。</p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cworld1/linux-learning/blob/main/docs/main/09-process-management.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/main/network-config-and-tools"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">网络配置与网络工具</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/main/sys-monitor-and-log"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">系统监视与系统日志</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#内容要点" class="table-of-contents__link toc-highlight">内容要点</a></li><li><a href="#进程相关概念" class="table-of-contents__link toc-highlight">进程相关概念</a><ul><li><a href="#程序进程和作业" class="table-of-contents__link toc-highlight">程序、进程和作业</a></li><li><a href="#进程" class="table-of-contents__link toc-highlight">进程</a></li><li><a href="#linux-是多用户多任务系统" class="table-of-contents__link toc-highlight">Linux 是多用户多任务系统</a></li><li><a href="#进程的启动方式" class="table-of-contents__link toc-highlight">进程的启动方式</a></li><li><a href="#前台与后台" class="table-of-contents__link toc-highlight">前台与后台</a></li></ul></li><li><a href="#管理进程" class="table-of-contents__link toc-highlight">管理进程</a><ul><li><a href="#查看系统种的进程ps" class="table-of-contents__link toc-highlight">查看系统种的进程（ps）</a></li><li><a href="#搜索进程" class="table-of-contents__link toc-highlight">搜索进程</a></li><li><a href="#进程调度的优先权" class="table-of-contents__link toc-highlight">进程调度的优先权</a></li><li><a href="#改变进程调度优先权" class="table-of-contents__link toc-highlight">改变进程调度优先权</a></li><li><a href="#进程信号signal" class="table-of-contents__link toc-highlight">进程信号（signal）</a></li><li><a href="#进程信号和信号发送" class="table-of-contents__link toc-highlight">进程信号和信号发送</a></li><li><a href="#杀死进程" class="table-of-contents__link toc-highlight">杀死进程</a></li><li><a href="#作业控制" class="table-of-contents__link toc-highlight">作业控制</a></li></ul></li><li><a href="#守护进程" class="table-of-contents__link toc-highlight">守护进程</a><ul><li><a href="#守护进程的分类" class="table-of-contents__link toc-highlight">守护进程的分类</a></li><li><a href="#客户机服务器模型" class="table-of-contents__link toc-highlight">客户机/服务器模型</a></li><li><a href="#网络守护进程的工作原理" class="table-of-contents__link toc-highlight">网络守护进程的工作原理</a></li><li><a href="#超级服务器的引入" class="table-of-contents__link toc-highlight">超级服务器的引入</a></li><li><a href="#守护进程的启动方式" class="table-of-contents__link toc-highlight">守护进程的启动方式</a></li></ul></li><li><a href="#守护进程管理工具" class="table-of-contents__link toc-highlight">守护进程管理工具</a><ul><li><a href="#用-chkconfig-管理守护进程" class="table-of-contents__link toc-highlight">用 chkconfig 管理守护进程</a></li><li><a href="#管理守护进程" class="table-of-contents__link toc-highlight">管理守护进程</a></li><li><a href="#超级服务器" class="table-of-contents__link toc-highlight">超级服务器</a></li></ul></li><li><a href="#tcp-wrappers" class="table-of-contents__link toc-highlight">TCP Wrappers</a><ul><li><a href="#tcp-wrappers-实现访问控制" class="table-of-contents__link toc-highlight">TCP Wrappers 实现访问控制</a></li><li><a href="#tcp-wrappers-保护机制的实现方式" class="table-of-contents__link toc-highlight">TCP Wrappers 保护机制的实现方式</a></li><li><a href="#tcp-wrappers-与防火墙" class="table-of-contents__link toc-highlight">TCP Wrappers 与防火墙</a></li><li><a href="#tcp-wrappers-的配置文件语法" class="table-of-contents__link toc-highlight">TCP Wrappers 的配置文件语法</a></li></ul></li><li><a href="#安排自动化任务" class="table-of-contents__link toc-highlight">安排自动化任务</a><ul><li><a href="#crond-守护进程" class="table-of-contents__link toc-highlight">crond 守护进程</a></li><li><a href="#crond-命令" class="table-of-contents__link toc-highlight">crond 命令</a></li><li><a href="#crontab-文件的格式" class="table-of-contents__link toc-highlight">crontab 文件的格式</a></li><li><a href="#cron-的使用" class="table-of-contents__link toc-highlight">cron 的使用</a></li><li><a href="#系统的-cron-任务" class="table-of-contents__link toc-highlight">系统的 cron 任务</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">笔记简述</a></li></ul></div><div class="col footer__col"><div class="footer__title">联系</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cworld.top/" target="_blank" rel="noopener noreferrer" class="footer__link-item">个人博客</a></li><li class="footer__item"><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ©2023 CWorld •           <a href="https://docusaurus.io/">Docusaurus 2</a> 强力驱动 •           总访问 <span id="busuanzi_value_site_pv">???</span> 次</div><script src="https://busuanzi.icodeq.com/busuanzi.pure.mini.js"></script></div></div></footer></div>
<script src="/assets/js/runtime~main.04dd30b5.js"></script>
<script src="/assets/js/main.9892e731.js"></script>
</body>
</html>