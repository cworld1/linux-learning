<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-main/disk-part-and-lvm">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">磁盘分区和 LVM | Linux Learning</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://linux.cworld.top/docs/main/disk-part-and-lvm"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="磁盘分区和 LVM | Linux Learning"><meta data-rh="true" name="description" content="关于 Linux 磁盘分区和 LVM 概念、实操的讲解。"><meta data-rh="true" property="og:description" content="关于 Linux 磁盘分区和 LVM 概念、实操的讲解。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://linux.cworld.top/docs/main/disk-part-and-lvm"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/disk-part-and-lvm" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/en/docs/main/disk-part-and-lvm" hreflang="en"><link data-rh="true" rel="alternate" href="https://linux.cworld.top/docs/main/disk-part-and-lvm" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Linux Learning RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Linux Learning Atom Feed"><link rel="stylesheet" href="/assets/css/styles.85142967.css">
<link rel="preload" href="/assets/js/runtime~main.f56d17aa.js" as="script">
<link rel="preload" href="/assets/js/main.e7267b0a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_BBcs" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="CWorld Logo" class="themedImage_J2sv themedImage--light_cbVa"><img src="/img/logo.svg" alt="CWorld Logo" class="themedImage_J2sv themedImage--dark_jfGI"></div><b class="navbar__title text--truncate">CWorld Project</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">笔记</a></div><div class="navbar__items navbar__items--right"><a href="https://blog.cworld.top/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">博客</a><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_RTLM"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/main/disk-part-and-lvm" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/main/disk-part-and-lvm" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><div class="toggle_pcYR colorModeToggle_B47n"><button class="clean-btn toggleButton_gqls toggleButtonDisabled_LqzU" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_O59b"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_mYor"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_Lb93"><div class="navbar__search searchBarContainer_LsXR"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_b4Y7 searchBarLoadingRing_Lsyu"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_cwhP docsWrapper_amJP"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_jxU9" type="button"></button><div class="docPage_H5uh"><aside class="theme-doc-sidebar-container docSidebarContainer_APgW"><div class="sidebarViewport_h9Qd"><div class="sidebar_m_4B"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_aK5t"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">笔记简述</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/课程说明">课程说明</a><button aria-label="打开/收起侧边栏菜单「课程说明」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/主要章节">主要章节</a><button aria-label="打开/收起侧边栏菜单「主要章节」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/linux-intro-and-install">Linux 介绍和安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/adv-char-operation">字符界面操作进阶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/main/disk-part-and-lvm">磁盘分区和 LVM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/file-sys-manage">文件系统管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/account-and-authority-manage">账户管理和权限管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/network-config-and-tools">网络配置与网络工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/process-management">进程管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/main/sys-monitor-and-log">系统监视与系统日志</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/附加章节">附加章节</a><button aria-label="打开/收起侧边栏菜单「附加章节」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_yIQ5"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_dpSd"><div class="docItemContainer_odLl"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer__9vB" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_BZAf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/主要章节"><span itemprop="name">主要章节</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">磁盘分区和 LVM</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_uPSR theme-doc-toc-mobile tocMobile_EIeq"><button type="button" class="clean-btn tocCollapsibleButton_bcUr">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>磁盘分区和 LVM</h1><p>关于 Linux 磁盘分区和 LVM 概念、实操的讲解。</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="内容要点">内容要点<a href="#内容要点" class="hash-link" aria-label="内容要点的直接链接" title="内容要点的直接链接">​</a></h2><ul><li>Linux 磁盘分区的基本知识</li><li>学会使用磁盘分区工具 fdisk</li><li>学会创建文件系统和挂装</li><li>理解静态分区的缺点以及 LVM 的优势</li><li>掌握 LVM 的相关术语以及逻辑结构</li><li>LVM 系统的创建</li><li>学会扩展和缩减卷组以及逻辑卷</li></ul><h2 class="anchor anchorWithStickyNavbar_J8e2" id="磁盘的两种分区管理方式">磁盘的两种分区管理方式<a href="#磁盘的两种分区管理方式" class="hash-link" aria-label="磁盘的两种分区管理方式的直接链接" title="磁盘的两种分区管理方式的直接链接">​</a></h2><p>静态硬盘分区：通过静态分区管理，首先需要在磁盘上创建主分区、扩展分区和逻辑分区，然后对这些分区进行管理。</p><p>动态硬盘分区 LVM：在动态磁盘上存储数据，首先需要在磁盘上创建动态的卷组和逻辑卷，然后对这些卷进行管理。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="磁盘分区的设备名">磁盘分区的设备名<a href="#磁盘分区的设备名" class="hash-link" aria-label="磁盘分区的设备名的直接链接" title="磁盘分区的设备名的直接链接">​</a></h3><p>在 Linux 当中我们通过设备名来访问设备。Linux 下的所有设备名存放在 /dev 目录中。</p><p><img loading="lazy" alt="image-20220927193431224" src="/assets/images/image-20220927193431224-1a87875f2085914ecf9ce584e5b05c47.png" width="963" height="411" class="img_ABpA"></p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="linux-中分区的设备名">Linux 中分区的设备名<a href="#linux-中分区的设备名" class="hash-link" aria-label="Linux 中分区的设备名的直接链接" title="Linux 中分区的设备名的直接链接">​</a></h3><table><thead><tr><th>分区</th><th>分区设备名</th></tr></thead><tbody><tr><td>IDE 第 1 个硬盘（master）的第 1 个主分区</td><td>/dev/hda1</td></tr><tr><td>IDE 第 1 个硬盘（master）的第 2 个主分区</td><td>/dev/hda2</td></tr><tr><td>IDE 第 1 个硬盘（master）的第 3 个主分区</td><td>/dev/hda3</td></tr><tr><td>IDE 第 1 个硬盘（master）的第 4 个主分区</td><td>/dev/hda4</td></tr><tr><td>IDE 第 1 个硬盘（master）的第 1 个逻辑分区</td><td>/dev/hda5</td></tr><tr><td>IDE 第 1 个硬盘（master）的第 2 个逻辑分区</td><td>/dev/hda6</td></tr><tr><td>…………</td><td>…</td></tr><tr><td>IDE 第 2 个硬盘（slave）的第 1 个主分区</td><td>/dev/hdb1</td></tr><tr><td>IDE 第 2 个硬盘（slave）的第 2 个主分区</td><td>/dev/hdb2</td></tr><tr><td>…………</td><td>…</td></tr><tr><td>SCSI 第 1 个硬盘的第 1 个主分区</td><td>/dev/sda1</td></tr><tr><td>SCSI 第 1 个硬盘的第 2 个主分区</td><td>/dev/sda2</td></tr><tr><td>…………</td><td>…</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="关于磁盘分区设备的说明">关于磁盘分区设备的说明<a href="#关于磁盘分区设备的说明" class="hash-link" aria-label="关于磁盘分区设备的说明的直接链接" title="关于磁盘分区设备的说明的直接链接">​</a></h3><ul><li>与 Windows 系统不同，Linux 环境下没有盘符的概念。我们需要通过设备名对磁盘进行相应的操作。</li><li>IDE 接口硬盘的设备名均以 /dev/hd 开头；SCSI/SAS/SATA/USB 接口硬盘的设备名均以 /dev/sd 开头。</li><li>数字 1<!-- -->~<!-- -->4 留给主分区或扩展分区使用，逻辑分区编号从 5 开始。只能有一个扩展分区。</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="linux-与-windows-分区对比">Linux 与 Windows 分区对比<a href="#linux-与-windows-分区对比" class="hash-link" aria-label="Linux 与 Windows 分区对比的直接链接" title="Linux 与 Windows 分区对比的直接链接">​</a></h3><p><img loading="lazy" alt="image-20220927193821269" src="/assets/images/image-20220927193821269-f7d87191abe6d2a978404ed9df00a092.png" width="855" height="269" class="img_ABpA"></p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="linux-与-windows-系统共存的磁盘分区情况">Linux 与 Windows 系统共存的磁盘分区情况<a href="#linux-与-windows-系统共存的磁盘分区情况" class="hash-link" aria-label="Linux 与 Windows 系统共存的磁盘分区情况的直接链接" title="Linux 与 Windows 系统共存的磁盘分区情况的直接链接">​</a></h3><p><img loading="lazy" alt="image-20220927193852623" src="/assets/images/image-20220927193852623-10579cff4fcb6902a556259af09de449.png" width="861" height="377" class="img_ABpA"></p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="linux-如何使用分区">Linux 如何使用分区<a href="#linux-如何使用分区" class="hash-link" aria-label="Linux 如何使用分区的直接链接" title="Linux 如何使用分区的直接链接">​</a></h3><p><img loading="lazy" alt="image-20220927193933090" src="/assets/images/image-20220927193933090-7263b3e881a02f626e31ca50bee41c40.png" width="999" height="551" class="img_ABpA"></p><p>在 Linux 操作系统中没有 Windows 所谓磁盘分区概念，而是将每个分区当成目录使用，此指定的目录即称为挂载点（mount point）</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="磁盘分区工具">磁盘分区工具<a href="#磁盘分区工具" class="hash-link" aria-label="磁盘分区工具的直接链接" title="磁盘分区工具的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="fdisk磁盘分区工具命令详解">fdisk（磁盘分区工具）命令详解<a href="#fdisk磁盘分区工具命令详解" class="hash-link" aria-label="fdisk（磁盘分区工具）命令详解的直接链接" title="fdisk（磁盘分区工具）命令详解的直接链接">​</a></h3><p>fdisk 是 Linux 下的一个命令式磁盘分区工具。</p><p>格式：<code>fdisk &lt;硬盘设备名&gt;</code></p><p>选项：</p><table><thead><tr><th>子命令</th><th>说明</th></tr></thead><tbody><tr><td>a</td><td>调整硬盘的启动分区</td></tr><tr><td>d</td><td>删除一个硬盘分区</td></tr><tr><td>l</td><td>列出所有支持的分区类型</td></tr><tr><td>m</td><td>列出所有命令</td></tr><tr><td>n</td><td>创建一个新的分区</td></tr><tr><td>p</td><td>列出硬盘分区表</td></tr><tr><td>q</td><td>退出 fdisk，不保存更改</td></tr><tr><td>t</td><td>更改分区类型</td></tr><tr><td>u</td><td>切换所显示的分区大小的单位</td></tr><tr><td>w</td><td>把设置写入硬盘分区表之后退出</td></tr></tbody></table><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在命令行方式下显示指定硬盘的分区表信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">fdisk</span><span class="token plain"> -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">硬盘设备名</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意分区结束之后，使用 partprobe 命令重新读取分区表。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="mkfs创建文件系统命令详解">mkfs（创建文件系统）命令详解<a href="#mkfs创建文件系统命令详解" class="hash-link" aria-label="mkfs（创建文件系统）命令详解的直接链接" title="mkfs（创建文件系统）命令详解的直接链接">​</a></h3><p>格式：<code>$ mkfs -t &lt;fstype&gt; -c &lt;分区设备名&gt;</code></p><p>其中：</p><ul><li><code>-t fstype</code>：指定文件系统类型</li><li><code>-c</code>：建立文件系统前先检测有无坏块</li></ul><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mkfs</span><span class="token plain"> -t ext4 -c /dev/hda2 </span><span class="token comment" style="color:#999988;font-style:italic"># 创建 Linux 原生格式的文件系统</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 事实上一般文件系统都没有坏块，因此 -c 很多时候可以不加</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mkfs</span><span class="token plain"> -t vfat /dev/hdb2 </span><span class="token comment" style="color:#999988;font-style:italic"># 创建 Windows 原生格式的文件系统</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ mkfs.ext4 /dev/sda1</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="mount挂装文件系统命令详解">mount（挂装文件系统）命令详解<a href="#mount挂装文件系统命令详解" class="hash-link" aria-label="mount（挂装文件系统）命令详解的直接链接" title="mount（挂装文件系统）命令详解的直接链接">​</a></h3><p>功能：挂装文件系统</p><p>格式：<code>mount [选项] [&lt;分区设备名&gt;] [&lt;挂装点&gt;]</code></p><p>常用选项：</p><ul><li><code>-t &lt;文件系统类型&gt;</code>：指定文件系统类型</li><li><code>-r</code>：使用只读方式来挂载</li><li><code>-a</code>：挂装 /etc/fstab 文件中记录的设备</li><li><code>-o iocharset=cp936</code>：使挂装的设备可以显示中文文件名</li><li><code>-o loop</code>：使用回送设备挂装 ISO 文件和映像文件</li></ul><p>我们一般使用 <code>df -h</code> 检查挂装情况。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="unmount卸载文件系统命令详解">unmount（卸载文件系统）命令详解<a href="#unmount卸载文件系统命令详解" class="hash-link" aria-label="unmount（卸载文件系统）命令详解的直接链接" title="unmount（卸载文件系统）命令详解的直接链接">​</a></h3><p>命令格式：<code>$ umount &lt;分区设备名或挂装点&gt;</code></p><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /dev/hda6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /dev/sdb1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /opt</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="挂装卸装-文件系统的注意事项">挂装/卸装 文件系统的注意事项<a href="#挂装卸装-文件系统的注意事项" class="hash-link" aria-label="挂装/卸装 文件系统的注意事项的直接链接" title="挂装/卸装 文件系统的注意事项的直接链接">​</a></h3><ul><li>挂装点目录必须存在；</li><li>应该在挂装目录的上级目录下进行挂装操作；</li><li>不能在同一个挂装点目录下挂装两个文件系统；</li><li>当文件系统处于“busy”状态时不能进行卸装。</li></ul><p>文件系统处于“busy”状态的 3 种情况：</p><ul><li>文件系统上面有打开的文件</li><li>有进程正在使用此文件系统上</li><li>文件系统上面的缓存文件正在被使用</li></ul><h3 class="anchor anchorWithStickyNavbar_J8e2" id="fuser-命令详解">fuser 命令详解<a href="#fuser-命令详解" class="hash-link" aria-label="fuser 命令详解的直接链接" title="fuser 命令详解的直接链接">​</a></h3><p>fuser 命令可以根据文件（目录、设备）查找使用它的进程，同时也提供了杀死这些进程的方法。 如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看挂装点有哪些进程需要杀掉</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">fuser</span><span class="token plain"> -cu /mount_point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 杀死这些进程（向其发送[SIGKILL, 9]信号）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">fuser</span><span class="token plain"> -ck /mount_point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 卸载挂接点上的设备</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">umount</span><span class="token plain"> /mount_point</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="系统启动时自动挂装文件系统">系统启动时自动挂装文件系统<a href="#系统启动时自动挂装文件系统" class="hash-link" aria-label="系统启动时自动挂装文件系统的直接链接" title="系统启动时自动挂装文件系统的直接链接">​</a></h3><p>想要系统启动时自动挂装文件系统，则需要修改 /etc/fstab。</p><p>qfstab (file system table) 是一个纯文本文件，开机后，系统会自动搜索该文件中的内容，对列于该文件中的文件系统进行自动挂载。</p><blockquote><p>由于文件系统的自动挂装是开机后自动挂装的，所以在执行时需要仔细检查命令是否标准，如空格、TAB 、dev 单词错误等细节，避免开机错误卡死。</p><p>使用 <code>mount -a</code> 命令可以立即挂载 /etc/fstab 中的所有文件系统，也方便检查修改的文件是否有问题。</p><p>利用虚拟机本身的备份功能能有效地避免灾难（确信）</p></blockquote><p>/etc/fstab 文件的格式信息：</p><ol><li>每一行说明一个文件系统的挂载信息</li><li>每一行由 6 列信息组成，列与列之间用 TAB 键隔开，一般格式如下：</li></ol><p><img loading="lazy" alt="image-20220927201125528" src="/assets/images/image-20220927201125528-6dcd9871b9fe2b75d36538a5ad60b2b4.png" width="1085" height="310" class="img_ABpA"></p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="挂装选项">挂装选项<a href="#挂装选项" class="hash-link" aria-label="挂装选项的直接链接" title="挂装选项的直接链接">​</a></h3><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>defaults</td><td>使用 rw, suid, dev, exec, auto, nouser 和 async 挂装设备</td></tr><tr><td>acl/noacl</td><td>支持/不支持 POSIX Access Control Lists（ACL）</td></tr><tr><td>async/sync</td><td>以同步/非同步方式，执行文件系统的输入输出操作</td></tr><tr><td>atime/noatime</td><td>每次访问文件时都 更新/不更新 文件的访问时间，atime 为默认值，noatime 会提高文件系统的访问速度</td></tr><tr><td>auto/noauto</td><td>使用 mount -a 或开机时会不会自动挂装</td></tr><tr><td>dev/nodev</td><td>可不可以解读文件系统上的字符或区块特殊设备</td></tr><tr><td>exec/noexec</td><td>可以/不可以 执行文件系统上的二进制文件</td></tr><tr><td>suid/nosuid</td><td>开启/禁用 SUID 和 SGID 设置位</td></tr><tr><td>user/nouser</td><td>允许普通用户/仅超级用户来挂装此文件系统，若无显示定义，隐含启用 noexec,nosuid,nodev 参数</td></tr><tr><td>rw/ro</td><td>以读写/只读方式挂装文件系统</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="静态分区的缺点">静态分区的缺点<a href="#静态分区的缺点" class="hash-link" aria-label="静态分区的缺点的直接链接" title="静态分区的缺点的直接链接">​</a></h3><p>在安装 Linux 的过程中如何正确地评估各分区大小是一个难题，因为系统管理员不但要考虑到当前某个分区需要的容量，还要预见该分区以后可能需要的容量的最大值。</p><p>当某个分区空间耗尽时，通常的解决方法是：</p><ol><li>使用符号链接（但会破坏 Linux 文件系统的标准结构）</li><li>备份整个系统，清除硬盘，重新对硬盘分区，然后恢复数据到新分区（需要停机一段时间进行恢复操作）</li><li>使用调整分区大小的工具，如 Patition Magic 等（需要停机一段时间进行调整）</li></ol><h2 class="anchor anchorWithStickyNavbar_J8e2" id="lvm-相关术语">LVM 相关术语<a href="#lvm-相关术语" class="hash-link" aria-label="LVM 相关术语的直接链接" title="LVM 相关术语的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="基本概念">基本概念<a href="#基本概念" class="hash-link" aria-label="基本概念的直接链接" title="基本概念的直接链接">​</a></h3><p>LVM 是逻辑卷管理（Logical Volume Manager）的简称，它是 Linux 环境下对卷进行操作的抽象层，为文件系统屏蔽下层磁盘分区物理布局，从而提高磁盘分区管理的灵活性。</p><p>通过 LVM 系统管理员可以轻松管理磁盘分区，如：将若干个磁盘分区连接为一个整块的卷组（volume group），形成一个存储池。</p><p>管理员可以在卷组上随意创建逻辑卷组（logical volumes），并进一步在逻辑卷上创建文件系统。同样的，管理员也可以 通过 LVM 可以方便的调整卷组的大小，并可以对逻辑卷的大小进行调整。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="物理卷">物理卷<a href="#物理卷" class="hash-link" aria-label="物理卷的直接链接" title="物理卷的直接链接">​</a></h3><p>物理卷（physical volume, PV）在 LVM 系统中处于最底层。</p><p>物理卷可以是整个硬盘，硬盘上的分区，或者是从逻辑上与磁盘分区具有同样功能的设备（如：RAID）。</p><p>物理卷是 LVM 的基本存储逻辑块，但和基本的物理存储介质（如分区、硬盘等）比较，却包含有与 LVM 相关的管理参数。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="物理区域">物理区域<a href="#物理区域" class="hash-link" aria-label="物理区域的直接链接" title="物理区域的直接链接">​</a></h3><p>每一个物理卷被划分为基本单元（称为 Physical Extent, PE），具有唯一编号的 PE 是可以被 LVM 寻址的最小存储单元。</p><p>PE 的大小可根据实际情况在创建物理卷时指定，默认为 4MB。而 PE 的大小一旦确定将不能改变，同一个卷组中的所有物理卷的 PE 的大小需要保持一致。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="卷组">卷组<a href="#卷组" class="hash-link" aria-label="卷组的直接链接" title="卷组的直接链接">​</a></h3><p>卷组（Volume Group, VG）建立在物理卷之上，它由一个或多个物理卷组成。</p><ul><li>卷组创建好后，可以直接添加物理卷到卷组中。在卷组上可以创建一个或多个 LVM 分区”（逻辑卷）；</li><li>一个 LVM 系统中可以只有一个卷组，也可以包含多个卷组。</li></ul><p>LVM 的卷组可以看成非 LVM 系统中的物理磁盘。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="逻辑卷">逻辑卷<a href="#逻辑卷" class="hash-link" aria-label="逻辑卷的直接链接" title="逻辑卷的直接链接">​</a></h3><p>逻辑卷（Logical Volume, LV）建立在卷组之上，是从卷组中“切出”的一块空间。</p><p>逻辑卷创建之后，其大小可以按需伸缩。</p><p>LVM 的逻辑卷可以看成非 LVM 系统中的硬盘分区，在逻辑卷之上可以建立文件系统。</p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="逻辑区域">逻辑区域<a href="#逻辑区域" class="hash-link" aria-label="逻辑区域的直接链接" title="逻辑区域的直接链接">​</a></h3><p>逻辑卷也被划分为可被寻址的基本单位（称为 Logical Extent, LE）。</p><p>在同一个卷组中，LE 的大小和 PE 是相同的，并且一一对应。</p><h2 class="anchor anchorWithStickyNavbar_J8e2" id="lvm-的创建">LVM 的创建<a href="#lvm-的创建" class="hash-link" aria-label="LVM 的创建的直接链接" title="LVM 的创建的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="lvm-组织结构">LVM 组织结构<a href="#lvm-组织结构" class="hash-link" aria-label="LVM 组织结构的直接链接" title="LVM 组织结构的直接链接">​</a></h3><p><img loading="lazy" alt="image-20220927205900929" src="/assets/images/image-20220927205900929-3303064eb5a15a8d3ca1055c22a11efa.png" width="956" height="720" class="img_ABpA"></p><h3 class="anchor anchorWithStickyNavbar_J8e2" id="pv-vg-lv-的设备名">PV-VG-LV 的设备名<a href="#pv-vg-lv-的设备名" class="hash-link" aria-label="PV-VG-LV 的设备名的直接链接" title="PV-VG-LV 的设备名的直接链接">​</a></h3><table><thead><tr><th>名称</th><th>含义</th><th>设备名</th></tr></thead><tbody><tr><td>PV</td><td>物理卷：磁盘或分区</td><td><code>/dev/sda?</code></td></tr><tr><td>VG</td><td>卷组：一组磁盘和/或分区</td><td><code>/dev/&lt;VGname&gt;/(目录)</code></td></tr><tr><td>LV</td><td>逻辑卷：LVM 分区</td><td><code>/dev/&lt;VG name&gt;/&lt;LVname&gt;</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_J8e2" id="创建-lvm-系统的步骤">创建 LVM 系统的步骤<a href="#创建-lvm-系统的步骤" class="hash-link" aria-label="创建 LVM 系统的步骤的直接链接" title="创建 LVM 系统的步骤的直接链接">​</a></h3><p>创建 LVM 系统的步骤如下：</p><ul><li>创建 LVM 类型的分区</li><li>在新硬盘或分区上创建物理卷</li><li>将新创建的物理卷添加到卷组</li><li>在卷组中创建逻辑卷</li><li>在逻辑卷中创建文件系统</li><li>挂装创建的文件系统</li></ul><h2 class="anchor anchorWithStickyNavbar_J8e2" id="lvm-管理工具的使用">LVM 管理工具的使用<a href="#lvm-管理工具的使用" class="hash-link" aria-label="LVM 管理工具的使用的直接链接" title="LVM 管理工具的使用的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_J8e2" id="创建-lvm-的相关命令">创建 LVM 的相关命令<a href="#创建-lvm-的相关命令" class="hash-link" aria-label="创建 LVM 的相关命令的直接链接" title="创建 LVM 的相关命令的直接链接">​</a></h3><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 转换分区类型（就是之前的步骤）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">fdisk</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建物理卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pvcreate </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">磁盘或分区设备名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建卷组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vgcreate </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">卷组名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">物理卷设备名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建逻辑卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvcreate -L </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷大小</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">卷组名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvcreate -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">PE值</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> -n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">卷组名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 其中 PE 值可以通过使用命令 vgdisplay|grep &quot;Free PE&quot; 获得。一般用于精确分配所有剩下的空间</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 创建两个物理卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pvcreate /dev/sdb</span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1,5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 用已创建的2个物理卷创建名为 wwwVG 的卷组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vgcreate wwwVG /dev/sdb1 /dev/sdb5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 在 wwwVG 卷组中创建大小为2GB，名字为 www 的逻辑卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvcreate -L 2G -n www wwwVG</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="查看卷信息">查看卷信息<a href="#查看卷信息" class="hash-link" aria-label="查看卷信息的直接链接" title="查看卷信息的直接链接">​</a></h3><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 查看物理卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ pvdisplay </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">物理卷设备名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看卷组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vgdisplay </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">卷组名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 查看逻辑卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvdisplay </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷卷设备名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="扩展逻辑卷">扩展逻辑卷<a href="#扩展逻辑卷" class="hash-link" aria-label="扩展逻辑卷的直接链接" title="扩展逻辑卷的直接链接">​</a></h3><p>若卷组中无剩余空间，则首先需要扩展卷组：</p><ul><li>添加硬盘，在磁盘上创建 8e 类型的分区</li><li>在分区上创建物理卷</li><li>将物理卷添加到卷组中</li></ul><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">$ vgextend </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">卷组名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">物理卷设备名</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 若卷组中有剩余空间，扩展卷组中的逻辑卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvextend -L </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">+逻辑卷增量</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷设备名称</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvextend -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">+PE值</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷设备名称</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 对已扩展的逻辑卷中的文件系统进行容量扩展</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ resize2fs </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">分区或逻辑卷设备名</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如：</p><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 将两个物理卷扩展到已存在的VolGroup00卷组中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ vgextend VolGroup00 /dev/sdb1 /dev/sdb2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 在VolGroup00卷组中扩展LogVolHome逻辑卷，扩展大小为6GB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ lvextend -L +6G /dev/VolGroup00/LogVolHome</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 为home文件系统（ext4）扩充容量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ resize2fs -f /dev/VolGroup00/LogVolHome</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="缩减逻辑卷">缩减逻辑卷<a href="#缩减逻辑卷" class="hash-link" aria-label="缩减逻辑卷的直接链接" title="缩减逻辑卷的直接链接">​</a></h3><ul><li>使用 umount 命令卸载文件系统</li><li>使用 e2fsck 命令检查文件系统</li><li>使用 resize2fs 命令缩减文件系统容量</li></ul><div class="language-bash codeBlockContainer_azwa theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_kMmd"><pre tabindex="0" class="prism-code language-bash codeBlock_eq8c thin-scrollbar"><code class="codeBlockLines_M058"><span class="token-line" style="color:#393A34"><span class="token plain">resize2fs /dev/……</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">  3G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 缩减逻辑卷</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvreduce -L </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> -逻辑卷增量</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷设备名称</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lvreduce -l </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> -PE值</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">逻辑卷设备名称</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup_VjRJ"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_nkyW" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_nr7X"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_P_G1"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_J8e2" id="lvm-常用命令集">LVM 常用命令集<a href="#lvm-常用命令集" class="hash-link" aria-label="LVM 常用命令集的直接链接" title="LVM 常用命令集的直接链接">​</a></h3><table><thead><tr><th><strong>任务</strong></th><th><strong>PV</strong></th><th><strong>VG</strong></th><th><strong>LV</strong></th></tr></thead><tbody><tr><td>创建</td><td>pvcreate</td><td>vgcreate</td><td>lvcreate</td></tr><tr><td>删除</td><td>pvremove</td><td>vgremove</td><td>lvremove</td></tr><tr><td>扫描列表</td><td>pvscan</td><td>vgscan</td><td>lvscan</td></tr><tr><td>显示属性</td><td>pvdisplay</td><td>vgdisplay</td><td>lvdisplay</td></tr><tr><td>扩展</td><td></td><td>vgextend</td><td>lvextend</td></tr><tr><td>缩减</td><td></td><td>vgreduce</td><td>lvreduce</td></tr></tbody></table><blockquote><ul><li>可以使用 lvm help 命令显示上述命令的功能。</li><li>可以使用命令参数-h 查看每个命令的使用方法，如：<code># lvreduce -h</code></li></ul></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cworld1/linux-learning/blob/main/docs/main/03-disk-part-and-lvm.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OYEL" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_e0Br"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/main/adv-char-operation"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">字符界面操作进阶</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/main/file-sys-manage"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">文件系统管理</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Clu8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#内容要点" class="table-of-contents__link toc-highlight">内容要点</a></li><li><a href="#磁盘的两种分区管理方式" class="table-of-contents__link toc-highlight">磁盘的两种分区管理方式</a><ul><li><a href="#磁盘分区的设备名" class="table-of-contents__link toc-highlight">磁盘分区的设备名</a></li><li><a href="#linux-中分区的设备名" class="table-of-contents__link toc-highlight">Linux 中分区的设备名</a></li><li><a href="#关于磁盘分区设备的说明" class="table-of-contents__link toc-highlight">关于磁盘分区设备的说明</a></li><li><a href="#linux-与-windows-分区对比" class="table-of-contents__link toc-highlight">Linux 与 Windows 分区对比</a></li><li><a href="#linux-与-windows-系统共存的磁盘分区情况" class="table-of-contents__link toc-highlight">Linux 与 Windows 系统共存的磁盘分区情况</a></li><li><a href="#linux-如何使用分区" class="table-of-contents__link toc-highlight">Linux 如何使用分区</a></li></ul></li><li><a href="#磁盘分区工具" class="table-of-contents__link toc-highlight">磁盘分区工具</a><ul><li><a href="#fdisk磁盘分区工具命令详解" class="table-of-contents__link toc-highlight">fdisk（磁盘分区工具）命令详解</a></li><li><a href="#mkfs创建文件系统命令详解" class="table-of-contents__link toc-highlight">mkfs（创建文件系统）命令详解</a></li><li><a href="#mount挂装文件系统命令详解" class="table-of-contents__link toc-highlight">mount（挂装文件系统）命令详解</a></li><li><a href="#unmount卸载文件系统命令详解" class="table-of-contents__link toc-highlight">unmount（卸载文件系统）命令详解</a></li><li><a href="#挂装卸装-文件系统的注意事项" class="table-of-contents__link toc-highlight">挂装/卸装 文件系统的注意事项</a></li><li><a href="#fuser-命令详解" class="table-of-contents__link toc-highlight">fuser 命令详解</a></li><li><a href="#系统启动时自动挂装文件系统" class="table-of-contents__link toc-highlight">系统启动时自动挂装文件系统</a></li><li><a href="#挂装选项" class="table-of-contents__link toc-highlight">挂装选项</a></li><li><a href="#静态分区的缺点" class="table-of-contents__link toc-highlight">静态分区的缺点</a></li></ul></li><li><a href="#lvm-相关术语" class="table-of-contents__link toc-highlight">LVM 相关术语</a><ul><li><a href="#基本概念" class="table-of-contents__link toc-highlight">基本概念</a></li><li><a href="#物理卷" class="table-of-contents__link toc-highlight">物理卷</a></li><li><a href="#物理区域" class="table-of-contents__link toc-highlight">物理区域</a></li><li><a href="#卷组" class="table-of-contents__link toc-highlight">卷组</a></li><li><a href="#逻辑卷" class="table-of-contents__link toc-highlight">逻辑卷</a></li><li><a href="#逻辑区域" class="table-of-contents__link toc-highlight">逻辑区域</a></li></ul></li><li><a href="#lvm-的创建" class="table-of-contents__link toc-highlight">LVM 的创建</a><ul><li><a href="#lvm-组织结构" class="table-of-contents__link toc-highlight">LVM 组织结构</a></li><li><a href="#pv-vg-lv-的设备名" class="table-of-contents__link toc-highlight">PV-VG-LV 的设备名</a></li><li><a href="#创建-lvm-系统的步骤" class="table-of-contents__link toc-highlight">创建 LVM 系统的步骤</a></li></ul></li><li><a href="#lvm-管理工具的使用" class="table-of-contents__link toc-highlight">LVM 管理工具的使用</a><ul><li><a href="#创建-lvm-的相关命令" class="table-of-contents__link toc-highlight">创建 LVM 的相关命令</a></li><li><a href="#查看卷信息" class="table-of-contents__link toc-highlight">查看卷信息</a></li><li><a href="#扩展逻辑卷" class="table-of-contents__link toc-highlight">扩展逻辑卷</a></li><li><a href="#缩减逻辑卷" class="table-of-contents__link toc-highlight">缩减逻辑卷</a></li><li><a href="#lvm-常用命令集" class="table-of-contents__link toc-highlight">LVM 常用命令集</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">笔记</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">笔记简述</a></li></ul></div><div class="col footer__col"><div class="footer__title">联系</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://t.me/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cworld0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cworld.top/" target="_blank" rel="noopener noreferrer" class="footer__link-item">个人博客</a></li><li class="footer__item"><a href="https://github.com/cworld1/linux-learning" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GbyL"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ©2023 CWorld •           <a href="https://docusaurus.io/">Docusaurus 2</a> 强力驱动 •           总访问 <span id="busuanzi_value_site_pv">???</span> 次</div><script src="https://busuanzi.icodeq.com/busuanzi.pure.mini.js"></script></div></div></footer></div>
<script src="/assets/js/runtime~main.f56d17aa.js"></script>
<script src="/assets/js/main.e7267b0a.js"></script>
</body>
</html>